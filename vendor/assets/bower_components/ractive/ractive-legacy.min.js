!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Ractive=e()}(this,function(){"use strict";function t(t){var e;if(t&&"boolean"!=typeof t)return"undefined"!=typeof window&&document&&t?t.nodeType?t:"string"==typeof t&&(e=document.getElementById(t),!e&&document.querySelector&&(e=document.querySelector(t)),e&&e.nodeType)?e:t[0]&&t[0].nodeType?t[0]:null:null}function e(t){return t&&"unknown"!=typeof t.parentNode&&t.parentNode&&t.parentNode.removeChild(t),t}function n(t){return null!=t&&t.toString?t:""}function r(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;e>r;r++)n[r-1]=arguments[r];for(var i,s;s=n.shift();)for(i in s)ja.call(s,i)&&(t[i]=s[i]);return t}function i(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;e>r;r++)n[r-1]=arguments[r];return n.forEach(function(e){for(var n in e)!e.hasOwnProperty(n)||n in t||(t[n]=e[n])}),t}function s(t){return"[object Array]"===Ra.call(t)}function o(t){return Na.test(Ra.call(t))}function a(t,e){return null===t&&null===e?!0:"object"==typeof t||"object"==typeof e?!1:t===e}function u(t){return!isNaN(parseFloat(t))&&isFinite(t)}function h(t){return t&&"[object Object]"===Ra.call(t)}function c(t,e){return t.replace(/%s/g,function(){return e.shift()})}function l(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;e>r;r++)n[r-1]=arguments[r];throw t=c(t,n),new Error(t)}function f(){Kw.DEBUG&&Pa.apply(null,arguments)}function d(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;e>r;r++)n[r-1]=arguments[r];t=c(t,n),Ta(t,n)}function p(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;e>r;r++)n[r-1]=arguments[r];t=c(t,n),Da[t]||(Da[t]=!0,Ta(t,n))}function m(){Kw.DEBUG&&d.apply(null,arguments)}function v(){Kw.DEBUG&&p.apply(null,arguments)}function g(t,e,n){var r=y(t,e,n);return r?r[t][n]:null}function y(t,e,n){for(;e;){if(n in e[t])return e;if(e.isolated)return null;e=e.parent}}function w(t){return function(){return t}}function b(t){var e,n,r,i,s,o;for(e=t.split("."),(n=$a[e.length])||(n=x(e.length)),s=[],r=function(t,n){return t?"*":e[n]},i=n.length;i--;)o=n[i].map(r).join("."),s.hasOwnProperty(o)||(s.push(o),s[o]=!0);return s}function x(t){var e,n,r,i,s,o,a,u,h="";if(!$a[t]){for(r=[];h.length<t;)h+=1;for(e=parseInt(h,2),i=function(t){return"1"===t},s=0;e>=s;s+=1){for(n=s.toString(2);n.length<t;)n="0"+n;for(u=[],a=n.length,o=0;a>o;o++)u.push(i(n[o]));r[s]=u}$a[t]=r}return $a[t]}function k(t,e,n,r){var i=t[e];if(!i||!i.equalsOrStartsWith(r)&&i.equalsOrStartsWith(n))return t[e]=i?i.replace(n,r):r,!0}function E(t){var e=t.slice(2);return"i"===t[1]&&u(e)?+e:e}function _(t){return null==t?t:(Za.hasOwnProperty(t)||(Za[t]=new Ha(t)),Za[t])}function A(t,e){function n(e,n){var r,i,o;return n.isRoot?o=[].concat(Object.keys(t.viewmodel.data),Object.keys(t.viewmodel.mappings),Object.keys(t.viewmodel.computations)):(r=t.viewmodel.wrapped[n.str],i=r?r.get():t.viewmodel.get(n),o=i?Object.keys(i):null),o&&o.forEach(function(t){"_ractive"===t&&s(i)||e.push(n.join(t))}),e}var r,i,o;for(r=e.str.split("."),o=[Ga];i=r.shift();)"*"===i?o=o.reduce(n,[]):o[0]===Ga?o[0]=_(i):o=o.map(S(i));return o}function S(t){return function(e){return e.join(t)}}function C(t){return t?t.replace(qa,".$1"):""}function O(t,e,n){if("string"!=typeof e||!u(n))throw new Error("Bad arguments");var r=void 0,i=void 0;if(/\*/.test(e))return i={},A(t,_(C(e))).forEach(function(e){var r=t.viewmodel.get(e);if(!u(r))throw new Error(Ja);i[e.str]=r+n}),t.set(i);if(r=t.get(e),!u(r))throw new Error(Ja);return t.set(e,+r+n)}function P(t,e){return Ya(this,t,void 0===e?1:+e)}function T(t){this.event=t,this.method="on"+t,this.deprecate=ru[t]}function F(t,e){var n=t.indexOf(e);-1===n&&t.push(e)}function j(t,e){for(var n=0,r=t.length;r>n;n++)if(t[n]==e)return!0;return!1}function R(t,e){var n;if(!s(t)||!s(e))return!1;if(t.length!==e.length)return!1;for(n=t.length;n--;)if(t[n]!==e[n])return!1;return!0}function N(t){return"string"==typeof t?[t]:void 0===t?[]:t}function D(t){return t[t.length-1]}function L(t,e){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}function I(t){for(var e=[],n=t.length;n--;)e[n]=t[n];return e}function V(t){setTimeout(t,0)}function W(t,e){return function(){for(var n;n=t.shift();)n(e)}}function M(t,e,n,r){var i;if(e===t)throw new TypeError("A promise's fulfillment handler cannot return the same promise");if(e instanceof iu)e.then(n,r);else if(!e||"object"!=typeof e&&"function"!=typeof e)n(e);else{try{i=e.then}catch(s){return void r(s)}if("function"==typeof i){var o,a,u;a=function(e){o||(o=!0,M(t,e,n,r))},u=function(t){o||(o=!0,r(t))};try{i.call(e,a,u)}catch(s){if(!o)return r(s),void(o=!0)}}else n(e)}}function U(t,e,n){var r;return e=C(e),"~/"===e.substr(0,2)?(r=_(e.substring(2)),$(t,r.firstKey,n)):"."===e[0]?(r=z(cu(n),e),r&&$(t,r.firstKey,n)):r=B(t,_(e),n),r}function z(t,e){var n;if(void 0!=t&&"string"!=typeof t&&(t=t.str),"."===e)return _(t);if(n=t?t.split("."):[],"../"===e.substr(0,3)){for(;"../"===e.substr(0,3);){if(!n.length)throw new Error('Could not resolve reference - too many "../" prefixes');n.pop(),e=e.substring(3)}return n.push(e),_(n.join("."))}return _(t?t+e.replace(/^\.\//,"."):e.replace(/^\.\/?/,""))}function B(t,e,n,r){var i,s,o,a,u;if(e.isRoot)return e;for(s=e.firstKey;n;)if(i=n.context,n=n.parent,i&&(a=!0,o=t.viewmodel.get(i),o&&("object"==typeof o||"function"==typeof o)&&s in o))return i.join(e.str);return q(t.viewmodel,s)?e:t.parent&&!t.isolated&&(a=!0,n=t.component.parentFragment,s=_(s),u=B(t.parent,s,n,!0))?(t.viewmodel.map(s,{origin:t.parent.viewmodel,keypath:u}),e):r||a?void 0:(t.viewmodel.set(e,void 0),e)}function $(t,e){var n;!t.parent||t.isolated||q(t.viewmodel,e)||(e=_(e),(n=B(t.parent,e,t.component.parentFragment,!0))&&t.viewmodel.map(e,{origin:t.parent.viewmodel,keypath:n}))}function q(t,e){return""===e||e in t.data||e in t.computations||e in t.mappings}function Q(t){t.teardown()}function Z(t){t.unbind()}function H(t){t.unrender()}function K(t){t.cancel()}function G(t){t.detach()}function Y(t){t.detachNodes()}function J(t){!t.ready||t.outros.length||t.outroChildren||(t.outrosComplete||(t.parent?t.parent.decrementOutros(t):t.detachNodes(),t.outrosComplete=!0),t.intros.length||t.totalChildren||("function"==typeof t.callback&&t.callback(),t.parent&&t.parent.decrementTotal()))}function X(){for(var t,e,n;du.ractives.length;)e=du.ractives.pop(),n=e.viewmodel.applyChanges(),n&&gu.fire(e,n);for(tt(),t=0;t<du.views.length;t+=1)du.views[t].update();for(du.views.length=0,t=0;t<du.tasks.length;t+=1)du.tasks[t]();return du.tasks.length=0,du.ractives.length?X():void 0}function tt(){var t,e,n,r;for(t=vu.length;t--;)e=vu[t],e.keypath?vu.splice(t,1):(n=lu(e.root,e.ref,e.parentFragment))&&((r||(r=[])).push({item:e,keypath:n}),vu.splice(t,1));r&&r.forEach(et)}function et(t){t.item.resolve(t.keypath)}function nt(t,e,n){var r,i,s,o,a,u,h,c,l,f,d,p,m,v;if(r=new hu(function(t){return i=t}),"object"==typeof t){n=e||{},u=n.easing,h=n.duration,a=[],c=n.step,l=n.complete,(c||l)&&(d={},n.step=null,n.complete=null,f=function(t){return function(e,n){d[t]=n}});for(s in t)t.hasOwnProperty(s)&&((c||l)&&(p=f(s),n={easing:u,duration:h},c&&(n.step=p)),n.complete=l?p:Ea,a.push(rt(this,s,t[s],n)));return v={easing:u,duration:h},c&&(v.step=function(t){return c(t,d)}),l&&r.then(function(t){return l(t,d)}),v.complete=i,m=rt(this,null,null,v),a.push(m),r.stop=function(){for(var t;t=a.pop();)t.stop();m&&m.stop()},r}return n=n||{},n.complete&&r.then(n.complete),n.complete=i,o=rt(this,t,e,n),r.stop=function(){return o.stop()},r}function rt(t,e,n,r){var i,s,o,u;return e&&(e=_(C(e))),null!==e&&(u=t.viewmodel.get(e)),xu.abort(e,t),a(u,n)?(r.complete&&r.complete(r.to),Au):(r.easing&&(i="function"==typeof r.easing?r.easing:t.easing[r.easing],"function"!=typeof i&&(i=null)),s=void 0===r.duration?400:r.duration,o=new Eu({keypath:e,from:u,to:n,root:t,duration:s,easing:i,interpolator:r.interpolator,step:r.step,complete:r.complete}),xu.add(o),t._animations.push(o),o)}function it(){return this.detached?this.detached:(this.el&&L(this.el.__ractive_instances__,this),this.detached=this.fragment.detach(),Cu.fire(this),this.detached)}function st(t){return this.el?this.fragment.find(t):null}function ot(t,e){var n;return n=this._isComponentQuery?!this.selector||t.name===this.selector:t.node?fa(t.node,this.selector):null,n?(this.push(t.node||t.instance),e||this._makeDirty(),!0):void 0}function at(t){var e;return(e=t.parentFragment)?e.owner:t.component&&(e=t.component.parentFragment)?e.owner:void 0}function ut(t){var e,n;for(e=[t],n=at(t);n;)e.push(n),n=at(n);return e}function ht(t,e,n,r){var i=[];return Sa(i,{selector:{value:e},live:{value:n},_isComponentQuery:{value:r},_test:{value:Pu}}),n?(Sa(i,{cancel:{value:Tu},_root:{value:t},_sort:{value:Ru},_makeDirty:{value:Nu},_remove:{value:Du},_dirty:{value:!1,writable:!0}}),i):i}function ct(t,e){var n,r;return this.el?(e=e||{},n=this._liveQueries,(r=n[t])?e&&e.live?r:r.slice():(r=Lu(this,t,!!e.live,!1),r.live&&(n.push(t),n["_"+t]=r),this.fragment.findAll(t,r),r)):[]}function lt(t,e){var n,r;return e=e||{},n=this._liveComponentQueries,(r=n[t])?e&&e.live?r:r.slice():(r=Lu(this,t,!!e.live,!0),r.live&&(n.push(t),n["_"+t]=r),this.fragment.findAllComponents(t,r),r)}function ft(t){return this.fragment.findComponent(t)}function dt(t){return this.container?this.container.component&&this.container.component.name===t?this.container:this.container.findContainer(t):null}function pt(t){return this.parent?this.parent.component&&this.parent.component.name===t?this.parent:this.parent.findParent(t):null}function mt(t,e){var n=void 0===arguments[2]?{}:arguments[2];if(e){n.event?n.event.name=e:n.event={name:e,_noArg:!0};var r=_(e).wildcardMatches();vt(t,r,n.event,n.args,!0)}}function vt(t,e,n,r){var i,s,o=void 0===arguments[4]?!1:arguments[4],a=!0;for(Bu.enqueue(t,n),s=e.length;s>=0;s--)i=t._subs[e[s]],i&&(a=gt(t,i,n,r)&&a);if(Bu.dequeue(t),t.parent&&a){if(o&&t.component){var u=t.component.name+"."+e[e.length-1];e=_(u).wildcardMatches(),n&&(n.component=t)}vt(t.parent,e,n,r)}}function gt(t,e,n,r){var i=null,s=!1;n&&!n._noArg&&(r=[n].concat(r)),e=e.slice();for(var o=0,a=e.length;a>o;o+=1)e[o].apply(t,r)===!1&&(s=!0);return n&&!n._noArg&&s&&(i=n.original)&&(i.preventDefault&&i.preventDefault(),i.stopPropagation&&i.stopPropagation()),!s}function yt(t){var e={args:Array.prototype.slice.call(arguments,1)};$u(this,t,e)}function wt(t){var e;return t=_(C(t)),e=this.viewmodel.get(t,Zu),void 0===e&&this.parent&&!this.isolated&&lu(this,t.str,this.component.parentFragment)&&(e=this.viewmodel.get(t)),e}function bt(e,n){if(!this.fragment.rendered)throw new Error("The API has changed - you must call `ractive.render(target[, anchor])` to render your Ractive instance. Once rendered you can use `ractive.insert()`.");if(e=t(e),n=t(n)||null,!e)throw new Error("You must specify a valid target to insert into");e.insertBefore(this.detach(),n),this.el=e,(e.__ractive_instances__||(e.__ractive_instances__=[])).push(this),this.detached=null,xt(this)}function xt(t){Ku.fire(t),t.findAllComponents("*").forEach(function(t){xt(t.instance)})}function kt(t,e,n){var r,i;return t=_(C(t)),r=this.viewmodel.get(t),s(r)&&s(e)?(i=yu.start(this,!0),this.viewmodel.merge(t,r,e,n),yu.end(),i):this.set(t,e,n&&n.complete)}function Et(t,e){var n,r;return n=A(t,e),r={},n.forEach(function(e){r[e.str]=t.get(e.str)}),r}function _t(t,e,n,r){var i,s,o;e=_(C(e)),r=r||ch,e.isPattern?(i=new uh(t,e,n,r),t.viewmodel.patternObservers.push(i),s=!0):i=new Xu(t,e,n,r),i.init(r.init),t.viewmodel.register(e,i,s?"patternObservers":"observers"),i.ready=!0;var a={cancel:function(){var n;o||(s?(n=t.viewmodel.patternObservers.indexOf(i),t.viewmodel.patternObservers.splice(n,1),t.viewmodel.unregister(e,i,"patternObservers")):t.viewmodel.unregister(e,i,"observers"),o=!0)}};return t._observers.push(a),a}function At(t,e,n){var r,i,s,o;if(h(t)){n=e,i=t,r=[];for(t in i)i.hasOwnProperty(t)&&(e=i[t],r.push(this.observe(t,e,n)));return{cancel:function(){for(;r.length;)r.pop().cancel()}}}if("function"==typeof t)return n=e,e=t,t="",hh(this,t,e,n);if(s=t.split(" "),1===s.length)return hh(this,t,e,n);for(r=[],o=s.length;o--;)t=s[o],t&&r.push(hh(this,t,e,n));return{cancel:function(){for(;r.length;)r.pop().cancel()}}}function St(t,e,n){var r=this.observe(t,function(){e.apply(this,arguments),r.cancel()},{init:!1,defer:n&&n.defer});return r}function Ct(t,e){var n,r=this;if(t)n=t.split(" ").map(dh).filter(ph),n.forEach(function(t){var n,i;(n=r._subs[t])&&(e?(i=n.indexOf(e),-1!==i&&n.splice(i,1)):r._subs[t]=[])});else for(t in this._subs)delete this._subs[t];return this}function Ot(t,e){var n,r,i,s=this;if("object"==typeof t){n=[];for(r in t)t.hasOwnProperty(r)&&n.push(this.on(r,t[r]));return{cancel:function(){for(var t;t=n.pop();)t.cancel()}}}return i=t.split(" ").map(dh).filter(ph),i.forEach(function(t){(s._subs[t]||(s._subs[t]=[])).push(e)}),{cancel:function(){return s.off(t,e)}}}function Pt(t,e){var n=this.on(t,function(){e.apply(this,arguments),n.cancel()});return n}function Tt(t,e,n){var r,i,s,o,a,u,h=[];if(r=Ft(t,e,n),!r)return null;for(i=t.length,a=r.length-2-r[1],s=Math.min(i,r[0]),o=s+r[1],u=0;s>u;u+=1)h.push(u);for(;o>u;u+=1)h.push(-1);for(;i>u;u+=1)h.push(u+a);return h.touchedFrom=0!==a?r[0]:t.length,h}function Ft(t,e,n){switch(e){case"splice":for(void 0!==n[0]&&n[0]<0&&(n[0]=t.length+Math.max(n[0],-t.length));n.length<2;)n.push(0);return n[1]=Math.min(n[1],t.length-n[0]),n;case"sort":case"reverse":return null;case"pop":return t.length?[t.length-1,1]:[0,0];case"push":return[t.length,0].concat(n);case"shift":return[0,t.length?1:0];case"unshift":return[0,0].concat(n)}}function jt(e,n){var r,i,s,o=this;if(s=this.transitionsEnabled,this.noIntro&&(this.transitionsEnabled=!1),r=yu.start(this,!0),yu.scheduleTask(function(){return Th.fire(o)},!0),this.fragment.rendered)throw new Error("You cannot call ractive.render() on an already rendered instance! Call ractive.unrender() first");if(e=t(e)||this.el,n=t(n)||this.anchor,this.el=e,this.anchor=n,!this.append&&e){var a=e.__ractive_instances__;a&&a.length&&Rt(a),e.innerHTML=""}return this.cssId&&Oh.apply(),e&&((i=e.__ractive_instances__)?i.push(this):e.__ractive_instances__=[this],n?e.insertBefore(this.fragment.render(),n):e.appendChild(this.fragment.render())),yu.end(),this.transitionsEnabled=s,r.then(function(){return Fh.fire(o)})}function Rt(t){t.splice(0,t.length).forEach(Q)}function Nt(t,e){for(var n=t.slice(),r=e.length;r--;)~n.indexOf(e[r])||n.push(e[r]);return n}function Dt(t,e){var n,r,i;return r='[data-ractive-css~="{'+e+'}"]',i=function(t){var e,n,i,s,o,a,u,h=[];for(e=[];n=Ih.exec(t);)e.push({str:n[0],base:n[1],modifiers:n[2]});for(s=e.map(It),u=e.length;u--;)a=s.slice(),i=e[u],a[u]=i.base+r+i.modifiers||"",o=s.slice(),o[u]=r+" "+o[u],h.push(a.join(" "),o.join(" "));return h.join(", ")},n=Wh.test(t)?t.replace(Wh,r):t.replace(Lh,"").replace(Dh,function(t,e){var n,r;return Vh.test(e)?t:(n=e.split(",").map(Lt),r=n.map(i).join(", ")+" ",t.replace(e,r))})}function Lt(t){return t.trim?t.trim():t.replace(/^\s+/,"").replace(/\s+$/,"")}function It(t){return t.str}function Vt(t){t&&t.constructor!==Object&&("function"==typeof t||("object"!=typeof t?l("data option must be an object or a function, `"+t+"` is not valid"):m("If supplied, options.data should be a plain JavaScript object - using a non-POJO as the root object may work, but is discouraged")))}function Wt(t,e){Vt(e);var n="function"==typeof t,r="function"==typeof e;return e||n||(e={}),n||r?function(){var i=r?Mt(e,this):e,s=n?Mt(t,this):t;return Ut(i,s)}:Ut(e,t)}function Mt(t,e){var n=t.call(e);if(n)return"object"!=typeof n&&l("Data function must return an object"),n.constructor!==Object&&v("Data function returned something other than a plain JavaScript object. This might work, but is strongly discouraged"),n}function Ut(t,e){if(t&&e){for(var n in e)n in t||(t[n]=e[n]);return t}return t||e}function zt(t){var e,n,r;return t.matchString("=")?(e=t.pos,t.allowWhitespace(),(n=t.matchPattern(Lc))?t.matchPattern(Ic)?(r=t.matchPattern(Lc))?(t.allowWhitespace(),t.matchString("=")?[n,r]:(t.pos=e,null)):(t.pos=e,null):null:(t.pos=e,null)):null}function Bt(t){var e;return(e=t.matchPattern(Wc))?{t:gc,v:e}:null}function $t(t){var e,n;if(t.interpolate[t.inside]===!1)return null;for(n=0;n<t.tags.length;n+=1)if(e=qt(t,t.tags[n]))return e}function qt(t,e){var n,r,i,s;if(n=t.pos,t.matchString("\\"+e.open)){if(0===n||"\\"!==t.str[n-1])return e.open}else if(!t.matchString(e.open))return null;if(r=Dc(t))return t.matchString(e.close)?(e.open=r[0],e.close=r[1],t.sortMustacheTags(),Uc):null;if(t.allowWhitespace(),t.matchString("/")){t.pos-=1;var o=t.pos;Vc(t)?t.pos=o:(t.pos=o-e.close.length,t.error("Attempted to close a section that wasn't open"))}for(s=0;s<e.readers.length;s+=1)if(i=e.readers[s],r=i(t,e))return e.isStatic&&(r.s=!0),t.includeLinePositions&&(r.p=t.getLinePos(n)),r;return t.pos=n,null}function Qt(t){var e;return(e=t.matchPattern(qc))?{t:fc,v:e}:null}function Zt(t){var e=t.remaining();return"true"===e.substr(0,4)?(t.pos+=4,{t:vc,v:"true"}):"false"===e.substr(0,5)?(t.pos+=5,{t:vc,v:"false"}):null}function Ht(t){var e;return(e=Jc(t))?el.test(e.v)?e.v:'"'+e.v.replace(/"/g,'\\"')+'"':(e=$c(t))?e.v:(e=t.matchPattern(Xc))?e:void 0}function Kt(t){var e,n,r;return e=t.pos,t.allowWhitespace(),n=tl(t),null===n?(t.pos=e,null):(t.allowWhitespace(),t.matchString(":")?(t.allowWhitespace(),r=Fl(t),null===r?(t.pos=e,null):{t:wc,k:n,v:r}):(t.pos=e,null))}function Gt(t){var e,n,r,i;return e=t.pos,r=nl(t),null===r?null:(n=[r],t.matchString(",")?(i=Gt(t),i?n.concat(i):(t.pos=e,null)):n)}function Yt(t){function e(t){r.push(t)}var n,r,i,s;return n=t.pos,t.allowWhitespace(),i=Fl(t),null===i?null:(r=[i],t.allowWhitespace(),t.matchString(",")&&(s=Yt(t),null===s&&t.error(zc),s.forEach(e)),r)}function Jt(t){return $c(t)||Qc(t)||Jc(t)||il(t)||ol(t)||Vc(t)}function Xt(t){var e,n,r,i,s,o;return e=t.pos,r=t.matchPattern(/^@(?:keypath|index|key)/),r||(n=t.matchPattern(hl)||"",r=!n&&t.relaxedNames&&t.matchPattern(dl)||t.matchPattern(fl),r||"."!==n||(n="",r=".")),r?n||t.relaxedNames||!Hc.test(r)?!n&&Zc.test(r)?(i=Zc.exec(r)[0],t.pos=e+i.length,{t:yc,v:i}):(s=(n||"")+C(r),t.matchString("(")&&(o=s.lastIndexOf("."),-1!==o?(s=s.substr(0,o),t.pos=e+s.length):t.pos-=1),{t:bc,n:s.replace(/^this\./,"./").replace(/^this$/,".")}):(t.pos=e,null):null}function te(t){var e,n;return e=t.pos,t.matchString("(")?(t.allowWhitespace(),n=Fl(t),n||t.error(zc),t.allowWhitespace(),t.matchString(")")||t.error(Bc),{t:_c,x:n}):null}function ee(t){var e,n,r;if(e=t.pos,t.allowWhitespace(),t.matchString(".")){if(t.allowWhitespace(),n=t.matchPattern(Xc))return{t:xc,n:n};t.error("Expected a property name")}return t.matchString("[")?(t.allowWhitespace(),r=Fl(t),r||t.error(zc),t.allowWhitespace(),t.matchString("]")||t.error("Expected ']'"),{t:xc,x:r}):null}function ne(t){var e,n,r,i;return(n=Pl(t))?(e=t.pos,t.allowWhitespace(),t.matchString("?")?(t.allowWhitespace(),r=Fl(t),r||t.error(zc),t.allowWhitespace(),t.matchString(":")||t.error('Expected ":"'),t.allowWhitespace(),i=Fl(t),i||t.error(zc),{t:Ac,o:[n,r,i]}):(t.pos=e,n)):null}function re(t){return Tl(t)}function ie(t){function e(t){switch(t.t){case vc:case yc:case fc:case gc:return t.v;case dc:return JSON.stringify(String(t.v));case pc:return"["+(t.m?t.m.map(e).join(","):"")+"]";case mc:return"{"+(t.m?t.m.map(e).join(","):"")+"}";case wc:return t.k+":"+e(t.v);case Ec:return("typeof"===t.s?"typeof ":t.s)+e(t.o);case Sc:return e(t.o[0])+("in"===t.s.substr(0,2)?" "+t.s+" ":t.s)+e(t.o[1]);case Cc:return e(t.x)+"("+(t.o?t.o.map(e).join(","):"")+")";case _c:return"("+e(t.x)+")";case kc:return e(t.x)+e(t.r);case xc:return t.n?"."+t.n:"["+e(t.x)+"]";case Ac:return e(t.o[0])+"?"+e(t.o[1])+":"+e(t.o[2]);case bc:return"_"+n.indexOf(t.n);default:throw new Error("Expected legal JavaScript")}}var n;return se(t,n=[]),{r:n,s:e(t)}}function se(t,e){var n,r;if(t.t===bc&&-1===e.indexOf(t.n)&&e.unshift(t.n),r=t.o||t.m)if(h(r))se(r,e);else for(n=r.length;n--;)se(r[n],e);t.x&&se(t.x,e),t.r&&se(t.r,e),t.v&&se(t.v,e)}function oe(t,e){var n;if(t){for(;t.t===_c&&t.x;)t=t.x;return t.t===bc?e.r=t.n:t.t===fc&&Nl.test(t.v)?e.r=t.v:(n=ae(t))?e.rx=n:e.x=jl(t),e}}function ae(t){for(var e,n=[];t.t===kc&&t.r.t===xc;)e=t.r,n.unshift(e.x?e.x.t===bc?e.x:jl(e.x):e.n),t=t.x;return t.t!==bc?null:{r:t.n,m:n}}function ue(t,e){var n,r=Fl(t);return r?(t.matchString(e.close)||t.error("Expected closing delimiter '"+e.close+"'"),n={t:Jh},Rl(r,n),n):null}function he(t,e){var n,r;return t.matchString("&")?(t.allowWhitespace(),(n=Fl(t))?(t.matchString(e.close)||t.error("Expected closing delimiter '"+e.close+"'"),r={t:Jh},Rl(n,r),r):null):null}function ce(t,e){var n,r,i,s,o;return n=t.pos,t.matchString(">")?(t.allowWhitespace(),r=t.pos,t.relaxedNames=!0,i=Fl(t),t.relaxedNames=!1,t.allowWhitespace(),s=Fl(t),t.allowWhitespace(),i?(o={t:rc},Rl(i,o),t.allowWhitespace(),s&&(o={t:Xh,n:Fc,f:[o]},Rl(s,o)),t.matchString(e.close)||t.error("Expected closing delimiter '"+e.close+"'"),o):null):null}function le(t,e){var n;return t.matchString("!")?(n=t.remaining().indexOf(e.close),-1!==n?(t.pos+=n+e.close.length,{t:ic}):void 0):null}function fe(t,e){var n,r,i;if(n=t.pos,r=Fl(t),!r)return null;for(i=0;i<e.length;i+=1)if(t.remaining().substr(0,e[i].length)===e[i])return r;return t.pos=n,ul(t)}function de(t,e){var n,r,i,s;n=t.pos;try{r=Wl(t,[e.close])}catch(o){s=o}if(!r){if("!"===t.str.charAt(n))return t.pos=n,null;if(s)throw s}if(!t.matchString(e.close)&&(t.error("Expected closing delimiter '"+e.close+"' after reference"),!r)){if("!"===t.nextChar())return null;t.error("Expected expression or legal reference")}return i={t:Yh},Rl(r,i),i}function pe(t,e){var n,r,i;return t.matchPattern(zl)?(n=t.pos,r=t.matchPattern(/^[a-zA-Z_$][a-zA-Z_$0-9\-]*/),t.allowWhitespace(),t.matchString(e.close)||t.error("expected legal partial name"),i={t:hc},r&&(i.n=r),i):null}function me(t,e){var n,r,i,s;return n=t.pos,t.matchString(e.open)?(t.allowWhitespace(),t.matchString("/")?(t.allowWhitespace(),r=t.remaining(),i=r.indexOf(e.close),-1!==i?(s={t:ec,r:r.substr(0,i).split(" ")[0]},t.pos+=i,t.matchString(e.close)||t.error("Expected closing delimiter '"+e.close+"'"),s):(t.pos=n,null)):(t.pos=n,null)):null}function ve(t,e){var n=t.pos;return t.matchString(e.open)?t.matchPattern(ql)?(t.matchString(e.close)||t.error("Expected closing delimiter '"+e.close+"'"),{t:Rc}):(t.pos=n,null):null}function ge(t,e){var n,r=t.pos;return t.matchString(e.open)?t.matchPattern(Zl)?(n=Fl(t),t.matchString(e.close)||t.error("Expected closing delimiter '"+e.close+"'"),{t:Nc,x:n}):(t.pos=r,null):null}function ye(t,e){var n,r,i,s,o,a,u,h,c,l,f,d;if(n=t.pos,t.matchString("^"))i={t:Xh,f:[],n:Pc};else{if(!t.matchString("#"))return null;i={t:Xh,f:[]},t.matchString("partial")&&(t.pos=n-t.standardDelimiters[0].length,t.error("Partial definitions can only be at the top level of the template, or immediately inside components")),(u=t.matchPattern(Jl))&&(d=u,i.n=Hl[u])}if(t.allowWhitespace(),r=Fl(t),r||t.error("Expected expression"),f=t.matchPattern(Gl)){var p=void 0;i.i=(p=t.matchPattern(Yl))?f+","+p:f}t.allowWhitespace(),t.matchString(e.close)||t.error("Expected closing delimiter '"+e.close+"'"),t.sectionDepth+=1,o=i.f,c=[];do if(s=Bl(t,e))d&&s.r!==d&&t.error("Expected "+e.open+"/"+d+e.close),t.sectionDepth-=1,l=!0;else if(s=Ql(t,e))i.n===Pc&&t.error("{{else}} not allowed in {{#unless}}"),a&&t.error("illegal {{elseif...}} after {{else}}"),h||(h=we(r,i.n)),h.f.push({t:Xh,n:Oc,x:jl(xe(c.concat(s.x))),f:o=[]}),c.push(be(s.x));else if(s=$l(t,e))i.n===Pc&&t.error("{{else}} not allowed in {{#unless}}"),a&&t.error("there can only be one {{else}} block, at the end of a section"),a=!0,h?h.f.push({t:Xh,n:Oc,x:jl(xe(c)),f:o=[]}):(h=we(r,i.n),o=h.f);else{if(s=t.read(rd),!s)break;o.push(s)}while(!l);return h&&(i.n===Fc&&(i.n=jc),i.l=h),Rl(r,i),i.f.length||delete i.f,i}function we(t,e){var n;return e===Fc?(n={t:Xh,n:Oc,f:[]},Rl(be(t),n)):(n={t:Xh,n:Pc,f:[]},Rl(t,n)),n}function be(t){return t.t===Ec&&"!"===t.s?t.o:{t:Ec,s:"!",o:ke(t)}}function xe(t){return 1===t.length?t[0]:{t:Sc,s:"&&",o:[ke(t[0]),ke(xe(t.slice(1)))]}}function ke(t){return{t:_c,x:t}}function Ee(t){var e,n,r,i,s;return e=t.pos,t.matchString(tf)?(r=t.remaining(),i=r.indexOf(ef),-1===i&&t.error("Illegal HTML - expected closing comment sequence ('-->')"),n=r.substr(0,i),t.pos+=i+3,s={t:ic,c:n},t.includeLinePositions&&(s.p=t.getLinePos(e)),s):null}function _e(t){return t.replace(Al,function(t,e){var n;return n="#"!==e[0]?El[e]:"x"===e[1]?parseInt(e.substring(2),16):parseInt(e.substring(1),10),n?String.fromCharCode(Ae(n)):t})}function Ae(t){return t?10===t?32:128>t?t:159>=t?_l[t-128]:55296>t?t:57343>=t?65533:65535>=t?t:65533:65533}function Se(t){return t.replace(Ol,"&amp;").replace(Sl,"&lt;").replace(Cl,"&gt;")}function Ce(t){return"string"==typeof t}function Oe(t){return t.t===ic||t.t===sc}function Pe(t){return(t.t===Xh||t.t===tc)&&t.f}function Te(t,e,n,r,i){var o,a,u,h,c,l,f,d;for(ff(t),o=t.length;o--;)a=t[o],a.exclude?t.splice(o,1):e&&a.t===ic&&t.splice(o,1);for(df(t,r?gf:null,i?yf:null),o=t.length;o--;){if(a=t[o],a.f){var p=a.t===nc&&vf.test(a.e);c=n||p,!n&&p&&df(a.f,wf,bf),c||(u=t[o-1],h=t[o+1],(!u||"string"==typeof u&&yf.test(u))&&(l=!0),(!h||"string"==typeof h&&gf.test(h))&&(f=!0)),Te(a.f,e,c,l,f)}if(a.l&&(Te(a.l.f,e,n,l,f),t.splice(o+1,0,a.l),delete a.l),a.a)for(d in a.a)a.a.hasOwnProperty(d)&&"string"!=typeof a.a[d]&&Te(a.a[d],e,n,l,f);if(a.m&&Te(a.m,e,n,l,f),a.v)for(d in a.v)a.v.hasOwnProperty(d)&&(s(a.v[d].n)&&Te(a.v[d].n,e,n,l,f),s(a.v[d].d)&&Te(a.v[d].d,e,n,l,f))}for(o=t.length;o--;)"string"==typeof t[o]&&("string"==typeof t[o+1]&&(t[o]=t[o]+t[o+1],t.splice(o+1,1)),n||(t[o]=t[o].replace(mf," ")),""===t[o]&&t.splice(o,1))}function Fe(t){var e,n;return e=t.pos,t.matchString("</")?(n=t.matchPattern(kf))?t.inside&&n!==t.inside?(t.pos=e,null):{t:ac,e:n}:(t.pos-=2,void t.error("Illegal closing tag")):null}function je(t){var e,n,r;return t.allowWhitespace(),(n=t.matchPattern(Af))?(e={name:n},r=Re(t),null!=r&&(e.value=r),e):null}function Re(t){var e,n,r,i;return e=t.pos,/[=\/>\s]/.test(t.nextChar())||t.error("Expected `=`, `/`, `>` or whitespace"),t.allowWhitespace(),t.matchString("=")?(t.allowWhitespace(),n=t.pos,r=t.sectionDepth,i=Le(t,"'")||Le(t,'"')||De(t),null===i&&t.error("Expected valid attribute value"),t.sectionDepth!==r&&(t.pos=n,t.error("An attribute value must contain as many opening section tags as closing section tags")),i.length?1===i.length&&"string"==typeof i[0]?_e(i[0]):i:""):(t.pos=e,null)}function Ne(t){var e,n,r,i,s;return e=t.pos,(n=t.matchPattern(Sf))?(r=n,i=t.tags.map(function(t){return t.open}),-1!==(s=Ef(r,i))&&(n=n.substr(0,s),t.pos=e+n.length),n):null}function De(t){var e,n;for(t.inAttribute=!0,e=[],n=Mc(t)||Ne(t);null!==n;)e.push(n),n=Mc(t)||Ne(t);return e.length?(t.inAttribute=!1,e):null}function Le(t,e){var n,r,i;if(n=t.pos,!t.matchString(e))return null;for(t.inAttribute=e,r=[],i=Mc(t)||Ie(t,e);null!==i;)r.push(i),i=Mc(t)||Ie(t,e);return t.matchString(e)?(t.inAttribute=!1,r):(t.pos=n,null)}function Ie(t,e){var n,r,i,s;return n=t.pos,i=t.remaining(),s=t.tags.map(function(t){return t.open}),s.push(e),r=Ef(i,s),-1===r&&t.error("Quoted attribute value must have a closing quote"),r?(t.pos+=r,i.substr(0,r)):null}function Ve(t){var e,n,r;return t.allowWhitespace(),(e=tl(t))?(r={key:e},t.allowWhitespace(),t.matchString(":")?(t.allowWhitespace(),(n=t.read())?(r.value=n.v,r):null):null):null}function We(t,e){var n,r,i,s,o,a,u,h,c;if("string"==typeof t){if(r=Tf.exec(t)){var l=t.lastIndexOf(")");return Ff.test(t)||e.error("Invalid input after method call expression '"+t.slice(l+1)+"'"),n={m:r[1]},s="["+t.slice(n.m.length+1,l)+"]",i=new Cf(s),n.a=jl(i.result[0]),n}if(-1===t.indexOf(":"))return t.trim();t=[t]}if(n={},u=[],h=[],t){for(;t.length;)if(o=t.shift(),"string"==typeof o){if(a=o.indexOf(":"),-1!==a){a&&u.push(o.substr(0,a)),o.length>a+1&&(h[0]=o.substring(a+1));break}u.push(o)}else u.push(o);h=h.concat(t)}return u.length?h.length||"string"!=typeof u?(n={n:1===u.length&&"string"==typeof u[0]?u[0]:u},1===h.length&&"string"==typeof h[0]?(c=Of("["+h[0]+"]"),n.a=c?c.value:h[0].trim()):n.d=h):n=u:n="",n}function Me(t){var e,n,r,i,s,o,a,u,h,c,l,f,d,p,m,v;if(e=t.pos,t.inside||t.inAttribute)return null;if(!t.matchString("<"))return null;if("/"===t.nextChar())return null;if(n={},t.includeLinePositions&&(n.p=t.getLinePos(e)),t.matchString("!"))return n.t=lc,t.matchPattern(/^doctype/i)||t.error("Expected DOCTYPE declaration"),n.a=t.matchPattern(/^(.+?)>/),n;if(n.t=nc,n.e=t.matchPattern(Rf),!n.e)return null;for(Nf.test(t.nextChar())||t.error("Illegal tag name"),s=function(e,r){var i=r.n||r;If.test(i)&&(t.pos-=i.length,t.error("Cannot use reserved event names (change, reset, teardown, update, construct, config, init, render, unrender, detach, insert)")),n.v[e]=r},t.allowWhitespace();o=Mc(t)||_f(t);)o.name?(r=Vf[o.name])?n[r]=Pf(o.value,t):(i=Lf.exec(o.name))?(n.v||(n.v={}),a=Pf(o.value,t),s(i[1],a)):t.sanitizeEventAttributes&&Df.test(o.name)||(n.a||(n.a={}),n.a[o.name]=o.value||(""===o.value?"":0)):(n.m||(n.m=[]),n.m.push(o)),t.allowWhitespace();if(t.allowWhitespace(),t.matchString("/")&&(u=!0),!t.matchString(">"))return null;var g=n.e.toLowerCase(),y=t.preserveWhitespace;if(!u&&!kl.test(n.e)){t.elementStack.push(g),("script"===g||"style"===g)&&(t.inside=g),h=[],c=_a(null);do if(p=t.pos,m=t.remaining(),Ue(g,m))if(v=xf(t)){d=!0;var w=v.e.toLowerCase();if(w!==g&&(t.pos=p,!~t.elementStack.indexOf(w))){var b="Unexpected closing tag";kl.test(w)&&(b+=" (<"+w+"> is a void element - it cannot contain children)"),t.error(b)}}else(f=Bl(t,{open:t.standardDelimiters[0],close:t.standardDelimiters[1]}))?(d=!0,t.pos=p):(f=t.read(id))?(c[f.n]&&(t.pos=p,t.error("Duplicate partial definition")),pf(f.f,t.stripComments,y,!y,!y),c[f.n]=f.f,l=!0):(f=t.read(rd))?h.push(f):d=!0;else d=!0;while(!d);h.length&&(n.f=h),l&&(n.p=c),t.elementStack.pop()}return t.inside=null,t.sanitizeElements&&-1!==t.sanitizeElements.indexOf(g)?Wf:n}function Ue(t,e){var n,r;return n=/^<([a-zA-Z][a-zA-Z0-9]*)/.exec(e),r=jf[t],n&&r?!~r.indexOf(n[1].toLowerCase()):!0}function ze(t){var e,n,r,i;return n=t.remaining(),i=t.inside?"</"+t.inside:"<",t.inside&&!t.interpolate[t.inside]?e=n.indexOf(i):(r=t.tags.map(function(t){return t.open}),r=r.concat(t.tags.map(function(t){return"\\"+t.open})),t.inAttribute===!0?r.push('"',"'","=","<",">","`"):r.push(t.inAttribute?t.inAttribute:i),e=Ef(n,r)),e?(-1===e&&(e=n.length),t.pos+=e,t.inside?n.substr(0,e):_e(n.substr(0,e))):null}function Be(t){return t.replace($f,"\\$&")}function $e(t){var e=t.pos,n=t.standardDelimiters[0],r=t.standardDelimiters[1],i=void 0,s=void 0;if(!t.matchPattern(Qf)||!t.matchString(n))return t.pos=e,null;var o=t.matchPattern(Zf);if(v("Inline partial comments are deprecated.\nUse this...\n  {{#partial "+o+"}} ... {{/partial}}\n\n...instead of this:\n  <!-- {{>"+o+"}} --> ... <!-- {{/"+o+"}} -->'"),!t.matchString(r)||!t.matchPattern(Hf))return t.pos=e,null;i=[];var a=new RegExp("^<!--\\s*"+Bf(n)+"\\s*\\/\\s*"+o+"\\s*"+Bf(r)+"\\s*-->");do t.matchPattern(a)?s=!0:(Mf=t.read(rd),Mf||t.error("expected closing comment ('<!-- "+n+"/"+o+r+" -->')"),i.push(Mf));while(!s);return{t:cc,f:i,n:o}}function qe(t){var e,n,r,i,s;e=t.pos;var o=t.standardDelimiters;if(!t.matchString(o[0]))return null;if(!t.matchPattern(Gf))return t.pos=e,null;n=t.matchPattern(/^[a-zA-Z_$][a-zA-Z_$0-9\-]*/),n||t.error("expected legal partial name"),t.matchString(o[1])||t.error("Expected closing delimiter '"+o[1]+"'"),r=[];do(i=Bl(t,{open:t.standardDelimiters[0],close:t.standardDelimiters[1]}))?("partial"===!i.r&&t.error("Expected "+o[0]+"/partial"+o[1]),s=!0):(i=t.read(rd),i||t.error("Expected "+o[0]+"/partial"+o[1]),r.push(i));while(!s);return{t:cc,n:n,f:r}}function Qe(t){for(var e=[],n=_a(null),r=!1,i=t.preserveWhitespace;t.pos<t.str.length;){var s=t.pos,o=void 0,a=void 0;(a=t.read(id))?(n[a.n]&&(t.pos=s,t.error("Duplicated partial definition")),pf(a.f,t.stripComments,i,!i,!i),n[a.n]=a.f,r=!0):(o=t.read(rd))?e.push(o):t.error("Unexpected template content");

}var u={v:oa,t:e};return r&&(u.p=n),u}function Ze(t,e){return new nd(t,e||{}).result}function He(t){var e=_a(hd);return e.parse=function(e,n){return Ke(e,n||t)},e}function Ke(t,e)