!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Ractive=e()}(this,function(){"use strict";function t(t){var e;if(t&&"boolean"!=typeof t)return"undefined"!=typeof window&&document&&t?t.nodeType?t:"string"==typeof t&&(e=document.getElementById(t),!e&&document.querySelector&&(e=document.querySelector(t)),e&&e.nodeType)?e:t[0]&&t[0].nodeType?t[0]:null:null}function e(t){return t&&"unknown"!=typeof t.parentNode&&t.parentNode&&t.parentNode.removeChild(t),t}function n(t){return null!=t&&t.toString?t:""}function i(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;e>i;i++)n[i-1]=arguments[i];for(var r,o;o=n.shift();)for(r in o)Ps.call(o,r)&&(t[r]=o[r]);return t}function r(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;e>i;i++)n[i-1]=arguments[i];return n.forEach(function(e){for(var n in e)!e.hasOwnProperty(n)||n in t||(t[n]=e[n])}),t}function o(t){return"[object Array]"===Rs.call(t)}function s(t){return Ns.test(Rs.call(t))}function a(t,e){return null===t&&null===e?!0:"object"==typeof t||"object"==typeof e?!1:t===e}function u(t){return!isNaN(parseFloat(t))&&isFinite(t)}function h(t){return t&&"[object Object]"===Rs.call(t)}function c(t,e){return t.replace(/%s/g,function(){return e.shift()})}function l(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;e>i;i++)n[i-1]=arguments[i];throw t=c(t,n),new Error(t)}function f(){Pv.DEBUG&&Ts.apply(null,arguments)}function d(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;e>i;i++)n[i-1]=arguments[i];t=c(t,n),Fs(t,n)}function p(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;e>i;i++)n[i-1]=arguments[i];t=c(t,n),Ls[t]||(Ls[t]=!0,Fs(t,n))}function m(){Pv.DEBUG&&d.apply(null,arguments)}function v(){Pv.DEBUG&&p.apply(null,arguments)}function g(t,e,n){var i=y(t,e,n);return i?i[t][n]:null}function y(t,e,n){for(;e;){if(n in e[t])return e;if(e.isolated)return null;e=e.parent}}function b(t){return function(){return t}}function w(t){var e,n,i,r,o,s;for(e=t.split("."),(n=Qs[e.length])||(n=k(e.length)),o=[],i=function(t,n){return t?"*":e[n]},r=n.length;r--;)s=n[r].map(i).join("."),o.hasOwnProperty(s)||(o.push(s),o[s]=!0);return o}function k(t){var e,n,i,r,o,s,a,u,h="";if(!Qs[t]){for(i=[];h.length<t;)h+=1;for(e=parseInt(h,2),r=function(t){return"1"===t},o=0;e>=o;o+=1){for(n=o.toString(2);n.length<t;)n="0"+n;for(u=[],a=n.length,s=0;a>s;s++)u.push(r(n[s]));i[o]=u}Qs[t]=i}return Qs[t]}function E(t,e,n,i){var r=t[e];if(!r||!r.equalsOrStartsWith(i)&&r.equalsOrStartsWith(n))return t[e]=r?r.replace(n,i):i,!0}function x(t){var e=t.slice(2);return"i"===t[1]&&u(e)?+e:e}function _(t){return null==t?t:(Ks.hasOwnProperty(t)||(Ks[t]=new Gs(t)),Ks[t])}function A(t,e){function n(e,n){var i,r,s;return n.isRoot?s=[].concat(Object.keys(t.viewmodel.data),Object.keys(t.viewmodel.mappings),Object.keys(t.viewmodel.computations)):(i=t.viewmodel.wrapped[n.str],r=i?i.get():t.viewmodel.get(n),s=r?Object.keys(r):null),s&&s.forEach(function(t){"_ractive"===t&&o(r)||e.push(n.join(t))}),e}var i,r,s;for(i=e.str.split("."),s=[Ys];r=i.shift();)"*"===r?s=s.reduce(n,[]):s[0]===Ys?s[0]=_(r):s=s.map(C(r));return s}function C(t){return function(e){return e.join(t)}}function O(t){return t?t.replace(zs,".$1"):""}function S(t,e,n){if("string"!=typeof e||!u(n))throw new Error("Bad arguments");var i=void 0,r=void 0;if(/\*/.test(e))return r={},A(t,_(O(e))).forEach(function(e){var i=t.viewmodel.get(e);if(!u(i))throw new Error(Zs);r[e.str]=i+n}),t.set(r);if(i=t.get(e),!u(i))throw new Error(Zs);return t.set(e,+i+n)}function T(t,e){return Js(this,t,void 0===e?1:+e)}function F(t){this.event=t,this.method="on"+t,this.deprecate=ia[t]}function j(t,e){var n=t.indexOf(e);-1===n&&t.push(e)}function P(t,e){for(var n=0,i=t.length;i>n;n++)if(t[n]==e)return!0;return!1}function R(t,e){var n;if(!o(t)||!o(e))return!1;if(t.length!==e.length)return!1;for(n=t.length;n--;)if(t[n]!==e[n])return!1;return!0}function N(t){return"string"==typeof t?[t]:void 0===t?[]:t}function L(t){return t[t.length-1]}function V(t,e){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}function I(t){for(var e=[],n=t.length;n--;)e[n]=t[n];return e}function D(t){setTimeout(t,0)}function M(t,e){return function(){for(var n;n=t.shift();)n(e)}}function U(t,e,n,i){var r;if(e===t)throw new TypeError("A promise's fulfillment handler cannot return the same promise");if(e instanceof ra)e.then(n,i);else if(!e||"object"!=typeof e&&"function"!=typeof e)n(e);else{try{r=e.then}catch(o){return void i(o)}if("function"==typeof r){var s,a,u;a=function(e){s||(s=!0,U(t,e,n,i))},u=function(t){s||(s=!0,i(t))};try{r.call(e,a,u)}catch(o){if(!s)return i(o),void(s=!0)}}else n(e)}}function B(t,e,n){var i;return e=O(e),"~/"===e.substr(0,2)?(i=_(e.substring(2)),Q(t,i.firstKey,n)):"."===e[0]?(i=q(ca(n),e),i&&Q(t,i.firstKey,n)):i=W(t,_(e),n),i}function q(t,e){var n;if(void 0!=t&&"string"!=typeof t&&(t=t.str),"."===e)return _(t);if(n=t?t.split("."):[],"../"===e.substr(0,3)){for(;"../"===e.substr(0,3);){if(!n.length)throw new Error('Could not resolve reference - too many "../" prefixes');n.pop(),e=e.substring(3)}return n.push(e),_(n.join("."))}return _(t?t+e.replace(/^\.\//,"."):e.replace(/^\.\/?/,""))}function W(t,e,n,i){var r,o,s,a,u;if(e.isRoot)return e;for(o=e.firstKey;n;)if(r=n.context,n=n.parent,r&&(a=!0,s=t.viewmodel.get(r),s&&("object"==typeof s||"function"==typeof s)&&o in s))return r.join(e.str);return z(t.viewmodel,o)?e:t.parent&&!t.isolated&&(a=!0,n=t.component.parentFragment,o=_(o),u=W(t.parent,o,n,!0))?(t.viewmodel.map(o,{origin:t.parent.viewmodel,keypath:u}),e):i||a?void 0:(t.viewmodel.set(e,void 0),e)}function Q(t,e){var n;!t.parent||t.isolated||z(t.viewmodel,e)||(e=_(e),(n=W(t.parent,e,t.component.parentFragment,!0))&&t.viewmodel.map(e,{origin:t.parent.viewmodel,keypath:n}))}function z(t,e){return""===e||e in t.data||e in t.computations||e in t.mappings}function H(t){t.teardown()}function K(t){t.unbind()}function G(t){t.unrender()}function $(t){t.cancel()}function Y(t){t.detach()}function J(t){t.detachNodes()}function Z(t){!t.ready||t.outros.length||t.outroChildren||(t.outrosComplete||(t.parent?t.parent.decrementOutros(t):t.detachNodes(),t.outrosComplete=!0),t.intros.length||t.totalChildren||("function"==typeof t.callback&&t.callback(),t.parent&&t.parent.decrementTotal()))}function X(){for(var t,e,n;da.ractives.length;)e=da.ractives.pop(),n=e.viewmodel.applyChanges(),n&&ga.fire(e,n);for(tt(),t=0;t<da.views.length;t+=1)da.views[t].update();for(da.views.length=0,t=0;t<da.tasks.length;t+=1)da.tasks[t]();return da.tasks.length=0,da.ractives.length?X():void 0}function tt(){var t,e,n,i;for(t=va.length;t--;)e=va[t],e.keypath?va.splice(t,1):(n=la(e.root,e.ref,e.parentFragment))&&((i||(i=[])).push({item:e,keypath:n}),va.splice(t,1));i&&i.forEach(et)}function et(t){t.item.resolve(t.keypath)}function nt(t,e,n){var i,r,o,s,a,u,h,c,l,f,d,p,m,v;if(i=new ha(function(t){return r=t}),"object"==typeof t){n=e||{},u=n.easing,h=n.duration,a=[],c=n.step,l=n.complete,(c||l)&&(d={},n.step=null,n.complete=null,f=function(t){return function(e,n){d[t]=n}});for(o in t)t.hasOwnProperty(o)&&((c||l)&&(p=f(o),n={easing:u,duration:h},c&&(n.step=p)),n.complete=l?p:xs,a.push(it(this,o,t[o],n)));return v={easing:u,duration:h},c&&(v.step=function(t){return c(t,d)}),l&&i.then(function(t){return l(t,d)}),v.complete=r,m=it(this,null,null,v),a.push(m),i.stop=function(){for(var t;t=a.pop();)t.stop();m&&m.stop()},i}return n=n||{},n.complete&&i.then(n.complete),n.complete=r,s=it(this,t,e,n),i.stop=function(){return s.stop()},i}function it(t,e,n,i){var r,o,s,u;return e&&(e=_(O(e))),null!==e&&(u=t.viewmodel.get(e)),ka.abort(e,t),a(u,n)?(i.complete&&i.complete(i.to),Aa):(i.easing&&(r="function"==typeof i.easing?i.easing:t.easing[i.easing],"function"!=typeof r&&(r=null)),o=void 0===i.duration?400:i.duration,s=new xa({keypath:e,from:u,to:n,root:t,duration:o,easing:r,interpolator:i.interpolator,step:i.step,complete:i.complete}),ka.add(s),t._animations.push(s),s)}function rt(){return this.detached?this.detached:(this.el&&V(this.el.__ractive_instances__,this),this.detached=this.fragment.detach(),Oa.fire(this),this.detached)}function ot(t){return this.el?this.fragment.find(t):null}function st(t,e){var n;return n=this._isComponentQuery?!this.selector||t.name===this.selector:t.node?fs(t.node,this.selector):null,n?(this.push(t.node||t.instance),e||this._makeDirty(),!0):void 0}function at(t){var e;return(e=t.parentFragment)?e.owner:t.component&&(e=t.component.parentFragment)?e.owner:void 0}function ut(t){var e,n;for(e=[t],n=at(t);n;)e.push(n),n=at(n);return e}function ht(t,e,n,i){var r=[];return Cs(r,{selector:{value:e},live:{value:n},_isComponentQuery:{value:i},_test:{value:Ta}}),n?(Cs(r,{cancel:{value:Fa},_root:{value:t},_sort:{value:Ra},_makeDirty:{value:Na},_remove:{value:La},_dirty:{value:!1,writable:!0}}),r):r}function ct(t,e){var n,i;return this.el?(e=e||{},n=this._liveQueries,(i=n[t])?e&&e.live?i:i.slice():(i=Va(this,t,!!e.live,!1),i.live&&(n.push(t),n["_"+t]=i),this.fragment.findAll(t,i),i)):[]}function lt(t,e){var n,i;return e=e||{},n=this._liveComponentQueries,(i=n[t])?e&&e.live?i:i.slice():(i=Va(this,t,!!e.live,!0),i.live&&(n.push(t),n["_"+t]=i),this.fragment.findAllComponents(t,i),i)}function ft(t){return this.fragment.findComponent(t)}function dt(t){return this.container?this.container.component&&this.container.component.name===t?this.container:this.container.findContainer(t):null}function pt(t){return this.parent?this.parent.component&&this.parent.component.name===t?this.parent:this.parent.findParent(t):null}function mt(t,e){var n=void 0===arguments[2]?{}:arguments[2];if(e){n.event?n.event.name=e:n.event={name:e,_noArg:!0};var i=_(e).wildcardMatches();vt(t,i,n.event,n.args,!0)}}function vt(t,e,n,i){var r,o,s=void 0===arguments[4]?!1:arguments[4],a=!0;for(Wa.enqueue(t,n),o=e.length;o>=0;o--)r=t._subs[e[o]],r&&(a=gt(t,r,n,i)&&a);if(Wa.dequeue(t),t.parent&&a){if(s&&t.component){var u=t.component.name+"."+e[e.length-1];e=_(u).wildcardMatches(),n&&(n.component=t)}vt(t.parent,e,n,i)}}function gt(t,e,n,i){var r=null,o=!1;n&&!n._noArg&&(i=[n].concat(i)),e=e.slice();for(var s=0,a=e.length;a>s;s+=1)e[s].apply(t,i)===!1&&(o=!0);return n&&!n._noArg&&o&&(r=n.original)&&(r.preventDefault&&r.preventDefault(),r.stopPropagation&&r.stopPropagation()),!o}function yt(t){var e={args:Array.prototype.slice.call(arguments,1)};Qa(this,t,e)}function bt(t){var e;return t=_(O(t)),e=this.viewmodel.get(t,Ka),void 0===e&&this.parent&&!this.isolated&&la(this,t.str,this.component.parentFragment)&&(e=this.viewmodel.get(t)),e}function wt(e,n){if(!this.fragment.rendered)throw new Error("The API has changed - you must call `ractive.render(target[, anchor])` to render your Ractive instance. Once rendered you can use `ractive.insert()`.");if(e=t(e),n=t(n)||null,!e)throw new Error("You must specify a valid target to insert into");e.insertBefore(this.detach(),n),this.el=e,(e.__ractive_instances__||(e.__ractive_instances__=[])).push(this),this.detached=null,kt(this)}function kt(t){$a.fire(t),t.findAllComponents("*").forEach(function(t){kt(t.instance)})}function Et(t,e,n){var i,r;return t=_(O(t)),i=this.viewmodel.get(t),o(i)&&o(e)?(r=ya.start(this,!0),this.viewmodel.merge(t,i,e,n),ya.end(),r):this.set(t,e,n&&n.complete)}function xt(t,e){var n,i;return n=A(t,e),i={},n.forEach(function(e){i[e.str]=t.get(e.str)}),i}function _t(t,e,n,i){var r,o,s;e=_(O(e)),i=i||cu,e.isPattern?(r=new uu(t,e,n,i),t.viewmodel.patternObservers.push(r),o=!0):r=new Xa(t,e,n,i),r.init(i.init),t.viewmodel.register(e,r,o?"patternObservers":"observers"),r.ready=!0;var a={cancel:function(){var n;s||(o?(n=t.viewmodel.patternObservers.indexOf(r),t.viewmodel.patternObservers.splice(n,1),t.viewmodel.unregister(e,r,"patternObservers")):t.viewmodel.unregister(e,r,"observers"),s=!0)}};return t._observers.push(a),a}function At(t,e,n){var i,r,o,s;if(h(t)){n=e,r=t,i=[];for(t in r)r.hasOwnProperty(t)&&(e=r[t],i.push(this.observe(t,e,n)));return{cancel:function(){for(;i.length;)i.pop().cancel()}}}if("function"==typeof t)return n=e,e=t,t="",hu(this,t,e,n);if(o=t.split(" "),1===o.length)return hu(this,t,e,n);for(i=[],s=o.length;s--;)t=o[s],t&&i.push(hu(this,t,e,n));return{cancel:function(){for(;i.length;)i.pop().cancel()}}}function Ct(t,e,n){var i=this.observe(t,function(){e.apply(this,arguments),i.cancel()},{init:!1,defer:n&&n.defer});return i}function Ot(t,e){var n,i=this;if(t)n=t.split(" ").map(du).filter(pu),n.forEach(function(t){var n,r;(n=i._subs[t])&&(e?(r=n.indexOf(e),-1!==r&&n.splice(r,1)):i._subs[t]=[])});else for(t in this._subs)delete this._subs[t];return this}function St(t,e){var n,i,r,o=this;if("object"==typeof t){n=[];for(i in t)t.hasOwnProperty(i)&&n.push(this.on(i,t[i]));return{cancel:function(){for(var t;t=n.pop();)t.cancel()}}}return r=t.split(" ").map(du).filter(pu),r.forEach(function(t){(o._subs[t]||(o._subs[t]=[])).push(e)}),{cancel:function(){return o.off(t,e)}}}function Tt(t,e){var n=this.on(t,function(){e.apply(this,arguments),n.cancel()});return n}function Ft(t,e,n){var i,r,o,s,a,u,h=[];if(i=jt(t,e,n),!i)return null;for(r=t.length,a=i.length-2-i[1],o=Math.min(r,i[0]),s=o+i[1],u=0;o>u;u+=1)h.push(u);for(;s>u;u+=1)h.push(-1);for(;r>u;u+=1)h.push(u+a);return h.touchedFrom=0!==a?i[0]:t.length,h}function jt(t,e,n){switch(e){case"splice":for(void 0!==n[0]&&n[0]<0&&(n[0]=t.length+Math.max(n[0],-t.length));n.length<2;)n.push(0);return n[1]=Math.min(n[1],t.length-n[0]),n;case"sort":case"reverse":return null;case"pop":return t.length?[t.length-1,1]:[0,0];case"push":return[t.length,0].concat(n);case"shift":return[0,t.length?1:0];case"unshift":return[0,0].concat(n)}}function Pt(e,n){var i,r,o,s=this;if(o=this.transitionsEnabled,this.noIntro&&(this.transitionsEnabled=!1),i=ya.start(this,!0),ya.scheduleTask(function(){return ju.fire(s)},!0),this.fragment.rendered)throw new Error("You cannot call ractive.render() on an already rendered instance! Call ractive.unrender() first");if(e=t(e)||this.el,n=t(n)||this.anchor,this.el=e,this.anchor=n,!this.append&&e){var a=e.__ractive_instances__;a&&a.length&&Rt(a),e.innerHTML=""}return this.cssId&&Tu.apply(),e&&((r=e.__ractive_instances__)?r.push(this):e.__ractive_instances__=[this],n?e.insertBefore(this.fragment.render(),n):e.appendChild(this.fragment.render())),ya.end(),this.transitionsEnabled=o,i.then(function(){return Pu.fire(s)})}function Rt(t){t.splice(0,t.length).forEach(H)}function Nt(t,e){for(var n=t.slice(),i=e.length;i--;)~n.indexOf(e[i])||n.push(e[i]);return n}function Lt(t,e){var n,i,r;return i='[data-ractive-css~="{'+e+'}"]',r=function(t){var e,n,r,o,s,a,u,h=[];for(e=[];n=Du.exec(t);)e.push({str:n[0],base:n[1],modifiers:n[2]});for(o=e.map(It),u=e.length;u--;)a=o.slice(),r=e[u],a[u]=r.base+i+r.modifiers||"",s=o.slice(),s[u]=i+" "+s[u],h.push(a.join(" "),s.join(" "));return h.join(", ")},n=Uu.test(t)?t.replace(Uu,i):t.replace(Iu,"").replace(Vu,function(t,e){var n,i;return Mu.test(e)?t:(n=e.split(",").map(Vt),i=n.map(r).join(", ")+" ",t.replace(e,i))})}function Vt(t){return t.trim?t.trim():t.replace(/^\s+/,"").replace(/\s+$/,"")}function It(t){return t.str}function Dt(t){t&&t.constructor!==Object&&("function"==typeof t||("object"!=typeof t?l("data option must be an object or a function, `"+t+"` is not valid"):m("If supplied, options.data should be a plain JavaScript object - using a non-POJO as the root object may work, but is discouraged")))}function Mt(t,e){Dt(e);var n="function"==typeof t,i="function"==typeof e;return e||n||(e={}),n||i?function(){var r=i?Ut(e,this):e,o=n?Ut(t,this):t;return Bt(r,o)}:Bt(e,t)}function Ut(t,e){var n=t.call(e);if(n)return"object"!=typeof n&&l("Data function must return an object"),n.constructor!==Object&&v("Data function returned something other than a plain JavaScript object. This might work, but is strongly discouraged"),n}function Bt(t,e){if(t&&e){for(var n in e)n in t||(t[n]=e[n]);return t}return t||e}function qt(t){var e=_s(Gu);return e.parse=function(e,n){return Wt(e,n||t)},e}function Wt(t,e){if(!Hu)throw new Error("Missing Ractive.parse - cannot parse template. Either preparse or use the version that includes the parser");return Hu(t,e||this.options)}function Qt(t,e){var n;if(!Xo){if(e&&e.noThrow)return;throw new Error("Cannot retrieve template #"+t+" as Ractive is not running in a browser.")}if(zt(t)&&(t=t.substring(1)),!(n=document.getElementById(t))){if(e&&e.noThrow)return;throw new Error("Could not find template element with id #"+t)}if("SCRIPT"!==n.tagName.toUpperCase()){if(e&&e.noThrow)return;throw new Error("Template element with id #"+t+", must be a <script> element")}return"textContent"in n?n.textContent:n.innerHTML}function zt(t){return t&&"#"===t[0]}function Ht(t){return!("string"==typeof t)}function Kt(t){return t.defaults&&(t=t.defaults),Ku.reduce(function(e,n){return e[n]=t[n],e},{})}function Gt(t){var e,n=t._config.template;if(n&&n.fn)return e=$t(t,n.fn),e!==n.result?(n.result=e,e=Jt(e,t)):void 0}function $t(t,e){var n=Yt($u.getParseOptions(t));return e.call(t,n)}function Yt(t){var e=_s($u);return e.parse=function(e,n){return $u.parse(e,n||t)},e}function Jt(t,e){if("string"==typeof t)"#"===t[0]&&(t=$u.fromId(t)),t=Hu(t,$u.getParseOptions(e));else{if(void 0==t)throw new Error("The template cannot be "+t+".");if("number"!=typeof t.v)throw new Error("The template parser was passed a non-string template, but the template doesn't have a version.  Make sure you're passing in the template you think you are.");if(t.v!==ss)throw new Error("Mismatched template version (expected "+ss+", got "+t.v+") Please ensure you are using the latest version of Ractive.js in your build process as well as in your app")}return t}function Zt(t,e,n){if(e)for(var i in e)(n||!t.hasOwnProperty(i))&&(t[i]=e[i])}function Xt(t,e,n){if(!/_super/.test(n))return n;var i=function(){var t,r=te(i._parent,e),o="_super"in this,s=this._super;return this._super=r,t=n.apply(this,arguments),o?this._super=s:delete this._super,t};return i._parent=t,i._method=n,i}function te(t,e){var n,i;return e in t?(n=t[e],i="function"==typeof n?n:function(){return n}):i=xs,i}function ee(t,e,n){return"options."+t+" has been deprecated in favour of options."+e+"."+(n?" You cannot specify both options, please use options."+e+".":"")}function ne(t,e,n){if(e in t){if(n in t)throw new Error(ee(e,n,!0));m(ee(e,n)),t[n]=t[e]}}function ie(t){ne(t,"beforeInit","onconstruct"),ne(t,"init","onrender"),ne(t,"complete","oncomplete"),ne(t,"eventDefinitions","events"),o(t.adaptors)&&ne(t,"adaptors","adapt")}function re(t,e,n,i){sh(i);for(var r in i)if(ih.hasOwnProperty(r)){var o=i[r];"el"!==r&&"function"==typeof o?m(""+r+" is a Ractive option that does not expect a function and will be ignored","init"===t?n:null):n[r]=o}rh.forEach(function(r){r[t](e,n,i)}),Nu[t](e,n,i),Ju[t](e,n,i),Wu[t](e,n,i),oe(e.prototype,n,i)}function oe(t,e,n){for(var i in n)if(!nh[i]&&n.hasOwnProperty(i)){var r=n[i];"function"==typeof r&&(r=oh(t,i,r)),e[i]=r}}function se(t){var e={};return t.forEach(function(t){return e[t]=!0}),e}function ae(){this.dirtyValue=this.dirtyArgs=!0,this.bound&&"function"==typeof this.owner.bubble&&this.owner.bubble()}function ue(){var t;return 1===this.items.length?this.items[0].detach():(t=document.createDocumentFragment(),this.items.forEach(function(e){var n=e.detach();n&&t.appendChild(n)}),t)}function he(t){var e,n,i,r;if(this.items){for(n=this.items.length,e=0;n>e;e+=1)if(i=this.items[e],i.find&&(r=i.find(t)))return r;return null}}function ce(t,e){var n,i,r;if(this.items)for(i=this.items.length,n=0;i>n;n+=1)r=this.items[n],r.findAll&&r.findAll(t,e);return e}function le(t,e){var n,i,r;if(this.items)for(i=this.items.length,n=0;i>n;n+=1)r=this.items[n],r.findAllComponents&&r.findAllComponents(t,e);return e}function fe(t){var e,n,i,r;if(this.items){for(e=this.items.length,n=0;e>n;n+=1)if(i=this.items[n],i.findComponent&&(r=i.findComponent(t)))return r;return null}}function de(t){var e,n=t.index;return e=this.items[n+1]?this.items[n+1].firstNode():this.owner===this.root?this.owner.component?this.owner.component.findNextNode():null:this.owner.findNextNode(this)}function pe(){return this.items&&this.items[0]?this.items[0].firstNode():null}function me(t){var e;return(e=t.matchPattern(tc))?{t:Nh,v:e}:null}function ve(t){var e;return(e=Zh(t))?ic.test(e.v)?e.v:'"'+e.v.replace(/"/g,'\\"')+'"':(e=Xh(t))?e.v:(e=t.matchPattern(ec))?e:void 0}function ge(t){var e,n,i;return t.allowWhitespace(),(e=nc(t))?(i={key:e},t.allowWhitespace(),t.matchString(":")?(t.allowWhitespace(),(n=t.read())?(i.value=n.v,i):null):null):null}function ye(t,e,n,i){return i=i||0,t.map(function(t){var r,o,s;return t.text?t.text:t.fragments?t.fragments.map(function(t){return ye(t.items,e,n,i)}).join(""):(r=n+"-"+i++,s=t.keypath&&(o=t.root.viewmodel.wrapped[t.keypath.str])?o.value:t.getValue(),e[r]=s,"${"+r+"}")}).join("")}function be(){var t,e,n,i;return this.dirtyArgs&&(e=dc(this.items,t={},this.root._guid),n=fc("["+e+"]",t),i=n?n.value:[this.toString()],this.argsList=i,this.dirtyArgs=!1),this.argsList}function we(){var t=this;do if(t.pElement)return t.pElement.node;while(t=t.parent);return this.root.detached||this.root.el}function ke(){var t,e,n,i;return this.dirtyValue&&(e=dc(this.items,t={},this.root._guid),n=fc(e,t),i=n?n.value:this.toString(),this.value=i,this.dirtyValue=!1),this.value}function Ee(t){return t.replace(uc,function(t,e){var n;return n="#"!==e[0]?sc[e]:"x"===e[1]?parseInt(e.substring(2),16):parseInt(e.substring(1),10),n?String.fromCharCode(xe(n)):t})}function xe(t){return t?10===t?32:128>t?t:159>=t?ac[t-128]:55296>t?t:57343>=t?65533:65535>=t?t:65533:65533}function _e(t){return t.replace(lc,"&amp;").replace(hc,"&lt;").replace(cc,"&gt;")}function Ae(){this.registered&&this.root.viewmodel.unregister(this.keypath,this),this.resolver&&this.resolver.unbind()}function Ce(){return this.value}function Oe(t,e){for(var n,i=0;i<e.prop.length;i++)if(void 0!==(n=t[e.prop[i]]))return n}function Se(t,e){var n,i,r,o,s,a={},u=!1;for(e||(a.refs=n={});t;){if((s=t.owner)&&(i=s.indexRefs)){if(e&&(r=s.getIndexRef(e)))return a.ref={fragment:t,ref:r},a;if(!e)for(o in i)r=i[o],n[r.n]||(u=!0,n[r.n]={fragment:t,ref:r})}!t.parent&&t.owner&&t.owner.component&&t.owner.component.parentFragment&&!t.owner.component.instance.isolated?(a.componentBoundary=!0,t=t.owner.component.parentFragment):t=t.parent}return u?a:void 0}function Te(t,e,n){var i;return"@"===e.charAt(0)?new Cc(t,e,n):(i=Tc(t.parentFragment,e))?new Sc(t,i,n):new xc(t,e,n)}function Fe(t,e){var n,i;if(Rc[t])return Rc[t];for(i=[];e--;)i[e]="_"+e;return n=new Function(i.join(","),"return("+t+")"),Rc[t]=n,n}function je(t){return t.call()}function Pe(t,e){return t.replace(/_([0-9]+)/g,function(t,n){var i,r;return+n>=e.length?"_"+n:(i=e[n],void 0===i?"undefined":i.isSpecial?(r=i.value,"number"==typeof r?r:'"'+r+'"'):i.str)})}function Re(t){return _("${"+t.replace(/[\.\[\]]/g,"-").replace(/\*/,"#MUL#")+"}")}function Ne(t){return void 0!==t&&"@"!==t[0]}function Le(t,e){var n,i,r;if(t.__ractive_nowrap)return t;if(i="__ractive_"+e._guid,n=t[i])return n;if(/this/.test(t.toString())){As(t,i,{value:Nc.call(t,e),configurable:!0});for(r in t)t.hasOwnProperty(r)&&(t[i][r]=t[r]);return e._boundFunctions.push({fn:t,prop:i}),t[i]}return As(t,"__ractive_nowrap",{value:t}),t.__ractive_nowrap}function Ve(t){return t.value}function Ie(t){return void 0!=t}function De(t){t.forceResolution()}function Me(t,e){function n(e){t.resolve(e)}function i(e){var n=t.keypath;e!=n&&(t.resolve(e),void 0!==n&&t.fragments&&t.fragments.forEach(function(t){t.rebind(n,e)}))}var r,o,s;o=e.parentFragment,s=e.template,t.root=o.root,t.parentFragment=o,t.pElement=o.pElement,t.template=e.template,t.index=e.index||0,t.isStatic=e.template.s,t.type=e.template.t,t.registered=!1,(r=s.r)&&(t.resolver=jc(t,r,n)),e.template.x&&(t.resolver=new Lc(t,o,e.template.x,i)),e.template.rx&&(t.resolver=new Mc(t,e.template.rx,i)),t.template.n!==Dh||t.hasOwnProperty("value")||t.setValue(void 0)}function Ue(t){var e,n,i;return t&&t.isSpecial?(this.keypath=t,void this.setValue(t.value)):(this.registered&&(this.root.viewmodel.unregister(this.keypath,this),this.registered=!1,e=!0),this.keypath=t,void 0!=t&&(n=this.root.viewmodel.get(t),this.root.viewmodel.register(t,this),this.registered=!0),this.setValue(n),void(e&&(i=this.twowayBinding)&&i.rebound()))}function Be(t,e){this.fragments&&this.fragments.forEach(function(n){return n.rebind(t,e)}),this.resolver&&this.resolver.rebind(t,e)}function qe(){this.parentFragment.bubble()}function We(){var t;return 1===this.fragments.length?this.fragments[0].detach():(t=document.createDocumentFragment(),this.fragments.forEach(function(e){t.appendChild(e.detach())}),t)}function Qe(t){var e,n,i;for(n=this.fragments.length,e=0;n>e;e+=1)if(i=this.fragments[e].find(t))return i;return null}function ze(t,e){var n,i;for(i=this.fragments.length,n=0;i>n;n+=1)this.fragments[n].findAll(t,e)}function He(t,e){var n,i;for(i=this.fragments.length,n=0;i>n;n+=1)this.fragments[n].findAllComponents(t,e)}function Ke(t){var e,n,i;for(n=this.fragments.length,e=0;n>e;e+=1)if(i=this.fragments[e].findComponent(t))return i;return null}function Ge(t){return this.fragments[t.index+1]?this.fragments[t.index+1].firstNode():this.parentFragment.findNextNode(this)}function $e(){var t,e,n;if(t=this.fragments.length)for(e=0;t>e;e+=1)if(n=this.fragments[e].firstNode())return n;return this.parentFragment.findNextNode(this)}function Ye(t){var e,n,i,r,o,s,a,u=this;if(!this.shuffling&&!this.unbound&&this.currentSubtype===Mh){if(this.shuffling=!0,ya.scheduleTask(function(){return u.shuffling=!1}),e=this.parentFragment,o=[],t.forEach(function(t,e){var i,r,s,a,h;return t===e?void(o[t]=u.fragments[e]):(i=u.fragments[e],void 0===n&&(n=e),-1===t?(u.fragmentsToUnrender.push(i),void i.unbind()):(r=t-e,s=u.keypath.join(e),a=u.keypath.join(t),i.index=t,(h=i.registeredIndexRefs)&&h.forEach(Je),i.rebind(s,a),void(o[t]=i)))}),r=this.root.viewmodel.get(this.keypath).length,void 0===n){if(this.length===r)return;n=this.length}for(this.length=this.fragments.length=r,this.rendered&&ya.addView(this),s={template:this.template.f,root:this.root,owner:this},i=n;r>i;i+=1)a=o[i],a||this.fragmentsToCreate.push(i),this.fragments[i]=a}}function Je(t){t.rebind("","")}function Ze(){var t=this;return this.docFrag=document.createDocumentFragment(),this.fragments.forEach(function(e){return t.docFrag.appendChild(e.render())}),this.renderedFragments=this.fragments.slice(),this.fragmentsToRender=[],this.rendered=!0,this.docFrag}function Xe(t){var e,n,i=this;this.updating||(this.updating=!0,this.keypath&&(e=this.root.viewmodel.wrapped[this.keypath.str])&&(t=e.get()),this.fragmentsToCreate.length?(n={template:this.template.f||[],root:this.root,pElement:this.pElement,owner:this},this.fragmentsToCreate.forEach(function(t){var e;n.context=i.keypath.join(t),n.index=t,e=new rv(n),i.fragmentsToRender.push(i.fragments[t]=e)}),this.fragmentsToCreate.length=0):en(this,t)&&(this.bubble(),this.rendered&&ya.addView(this)),this.value=t,this.updating=!1)}function tn(t,e,n){if(e===Mh&&t.indexRefs&&t.indexRefs[0]){var i=t.indexRefs[0];(n&&"i"===i.t||!n&&"k"===i.t)&&(n||(t.length=0,t.fragmentsToUnrender=t.fragments.slice(0),t.fragmentsToUnrender.forEach(function(t){return t.unbind()}))),i.t=n?"k":"i"}t.currentSubtype=e}function en(t,e){var n={template:t.template.f||[],root:t.root,pElement:t.parentFragment.pElement,owner:t};if(t.hasContext=!0,t.subtype)switch(t.subtype){case Ih:return t.hasContext=!1,an(t,e,!1,n);case Dh:return t.hasContext=!1,an(t,e,!0,n);case Uh:return sn(t,n);case Bh:return on(t,e,n);case Mh:if(h(e))return tn(t,t.subtype,!0),rn(t,e,n)}return t.ordered=!!s(e),t.ordered?(tn(t,Mh,!1),nn(t,e,n)):h(e)||"function"==typeof e?t.template.i?(tn(t,Mh,!0),rn(t,e,n)):(tn(t,Uh,!1),sn(t,n)):(tn(t,Ih,!1),t.hasContext=!1,an(t,e,!1,n))}function nn(t,e,n){var i,r,o;if(r=e.length,r===t.length)return!1;if(r<t.length)t.fragmentsToUnrender=t.fragments.splice(r,t.length-r),t.fragmentsToUnrender.forEach(K);else if(r>t.length)for(i=t.length;r>i;i+=1)n.context=t.keypath.join(i),n.index=i,o=new rv(n),t.fragmentsToRender.push(t.fragments[i]=o);return t.length=r,!0}function rn(t,e,n){var i,r,o,s,a,u;for(o=t.hasKey||(t.hasKey={}),r=t.fragments.length;r--;)s=t.fragments[r],s.key in e||(a=!0,s.unbind(),t.fragmentsToUnrender.push(s),t.fragments.splice(r,1),o[s.key]=!1);for(r=t.fragments.length;r--;)s=t.fragments[r],s.index!==r&&(s.index=r,(u=s.registeredIndexRefs)&&u.forEach(cn));r=t.fragments.length;for(i in e)o[i]||(a=!0,n.context=t.keypath.join(i),n.key=i,n.index=r++,s=new rv(n),t.fragmentsToRender.push(s),t.fragments.push(s),o[i]=!0);return t.length=t.fragments.length,a}function on(t,e,n){return e?sn(t,n):un(t)}function sn(t,e){var n;return t.length?void 0:(e.context=t.keypath,e.index=0,n=new rv(e),t.fragmentsToRender.push(t.fragments[0]=n),t.length=1,!0)}function an(t,e,n,i){var r,o,a,u,c;if(o=s(e)&&0===e.length,a=!1,!s(e)&&h(e)){a=!0;for(c in e){a=!1;break}}return r=n?o||a||!e:e&&!o&&!a,r?t.length?t.length>1?(t.fragmentsToUnrender=t.fragments.splice(1),t.fragmentsToUnrender.forEach(K),!0):void 0:(i.index=0,u=new rv(i),t.fragmentsToRender.push(t.fragments[0]=u),t.length=1,!0):un(t)}function un(t){return t.length?(t.fragmentsToUnrender=t.fragments.splice(0,t.fragments.length).filter(hn),t.fragmentsToUnrender.forEach(K),t.length=t.fragmentsToRender.length=0,!0):void 0}function hn(t){return t.rendered}function cn(t){t.rebind("","")}function ln(t){var e,n,i;for(e="",n=0,i=this.length,n=0;i>n;n+=1)e+=this.fragments[n].toString(t);return e}function fn(){var t=this;this.fragments.forEach(K),this.fragmentsToRender.forEach(function(e){return V(t.fragments,e)}),this.fragmentsToRender=[],wc.call(this),this.length=0,this.unbound=!0}function dn(t){this.fragments.forEach(t?pn:mn),this.renderedFragments=[],this.rendered=!1}function pn(t){t.unrender(!0)}function mn(t){t.unrender(!1)}function vn(){var t,e,n,i,r,o,s;for(n=this.renderedFragments;t=this.fragmentsToUnrender.pop();)t.unrender(!0),n.splice(n.indexOf(t),1);for(;t=this.fragmentsToRender.shift();)t.render();for(this.rendered&&(r=this.parentFragment.getNode()),s=this.fragments.length,o=0;s>o;o+=1)t=this.fragments[o],e=n.indexOf(t,o),e!==o?(this.docFrag.appendChild(t.detach()),-1!==e&&n.splice(e,1),n.splice(o,0,t)):this.docFrag.childNodes.length&&(i=t.firstNode(),r.insertBefore(this.docFrag,i));this.rendered&&this.docFrag.childNodes.length&&(i=this.parentFragment.findNextNode(this),r.insertBefore(this.docFrag,i)),this.renderedFragments=this.fragments.slice()}function gn(){var t,e;if(this.docFrag){for(t=this.nodes.length,e=0;t>e;e+=1)this.docFrag.appendChild(this.nodes[e]);return this.docFrag}}function yn(t){var e,n,i,r;for(n=this.nodes.length,e=0;n>e;e+=1)if(i=this.nodes[e],1===i.nodeType){if(fs(i,t))return i;if(r=i.querySelector(t))return r}return null}function bn(t,e){var n,i,r,o,s,a;for(i=this.nodes.length,n=0;i>n;n+=1)if(r=this.nodes[n],1===r.nodeType&&(fs(r,t)&&e.push(r),o=r.querySelectorAll(t)))for(s=o.length,a=0;s>a;a+=1)e.push(o[a])}function wn(){return this.rendered&&this.nodes[0]?this.nodes[0]:this.parentFragment.findNextNode(this)}function kn(t){return vl[t]||(vl[t]=ls(t))}function En(t){var e,n,i;t&&"select"===t.name&&t.binding&&(e=I(t.node.options).filter(xn),t.getAttribute("multiple")?i=e.map(function(t){return t.value}):(n=e[0])&&(i=n.value),void 0!==i&&t.binding.setValue(i),t.bubble())}function xn(t){return t.selected}function _n(){if(this.rendered)throw new Error("Attempted to render an item that was already rendered");return this.docFrag=document.createDocumentFragment(),this.nodes=gl(this.value,this.parentFragment.getNode(),this.docFrag),yl(this.pElement),this.rendered=!0,this.docFrag}function An(t){var e;(e=this.root.viewmodel.wrapped[this.keypath.str])&&(t=e.get()),t!==this.value&&(this.value=t,this.parentFragment.bubble(),this.rendered&&ya.addView(this))}function Cn(){return void 0!=this.value?Ee(""+this.value):""}function On(t){this.rendered&&t&&(this.nodes.forEach(e),this.rendered=!1)}function Sn(){var t,e;if(this.rendered){for(;this.nodes&&this.nodes.length;)t=this.nodes.pop(),
t.parentNode.removeChild(t);e=this.parentFragment.getNode(),this.nodes=gl(this.value,e,this.docFrag),e.insertBefore(this.docFrag,this.parentFragment.findNextNode(this)),yl(this.pElement)}}function Tn(){var t,e=this.node;return e?((t=e.parentNode)&&t.removeChild(e),e):void 0}function Fn(){return null}function jn(){return this.node}function Pn(t){return this.attributes&&this.attributes[t]?this.attributes[t].value:void 0}function Rn(){var t=this.useProperty||!this.rendered?this.fragment.getValue():this.fragment.toString();a(t,this.value)||("id"===this.name&&this.value&&delete this.root.nodes[this.value],this.value=t,"value"===this.name&&this.node&&(this.node._ractive.value=t),this.rendered&&ya.addView(this))}function Nn(t){var e=t.fragment.items;if(1===e.length)return e[0].type===_h?e[0]:void 0}function Ln(t){return this.type=Fh,this.element=t.element,this.root=t.root,Ql(this,t.name),this.isBoolean=rc.test(this.name),t.value&&"string"!=typeof t.value?(this.parentFragment=this.element.parentFragment,this.fragment=new rv({template:t.value,root:this.root,owner:this}),this.value=this.fragment.getValue(),this.interpolator=zl(this),this.isBindable=!!this.interpolator&&!this.interpolator.isStatic,void(this.ready=!0)):void(this.value=this.isBoolean?!0:t.value||"")}function Vn(t,e){this.fragment&&this.fragment.rebind(t,e)}function In(t){var e;this.node=t,t.namespaceURI&&t.namespaceURI!==is.html||(e=$l[this.name]||this.name,void 0!==t[e]&&(this.propertyName=e),(this.isBoolean||this.isTwoway)&&(this.useProperty=!0),"value"===e&&(t._ractive.value=this.value)),this.rendered=!0,this.update()}function Dn(){var t=this,e=t.name,n=t.namespacePrefix,i=t.value,r=t.interpolator,o=t.fragment;if(("value"!==e||"select"!==this.element.name&&"textarea"!==this.element.name)&&("value"!==e||void 0===this.element.getAttribute("contenteditable"))){if("name"===e&&"input"===this.element.name&&r)return"name={{"+(r.keypath.str||r.ref)+"}}";if(this.isBoolean)return i?e:"";if(o){if(1===o.items.length&&null==o.items[0].value)return"";i=o.toString()}return n&&(e=n+":"+e),i?e+'="'+Mn(i)+'"':e}}function Mn(t){return t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function Un(){this.fragment&&this.fragment.unbind(),"id"===this.name&&delete this.root.nodes[this.value]}function Bn(){var t,e,n,i,r=this.value;if(!this.locked)for(this.node._ractive.value=r,t=this.node.options,i=t.length;i--;)if(e=t[i],n=e._ractive?e._ractive.value:e.value,n==r){e.selected=!0;break}}function qn(){var t,e,n,i,r=this.value;for(o(r)||(r=[r]),t=this.node.options,e=t.length;e--;)n=t[e],i=n._ractive?n._ractive.value:n.value,n.selected=P(r,i)}function Wn(){var t=this,e=t.node,n=t.value;e.checked=n==e._ractive.value}function Qn(){var t,e,n,i,r=this.node;if(t=r.checked,r.value=this.element.getAttribute("value"),r.checked=this.element.getAttribute("value")===this.element.getAttribute("name"),t&&!r.checked&&this.element.binding&&(n=this.element.binding.siblings,i=n.length)){for(;i--;){if(e=n[i],!e.element.node)return;if(e.element.node.checked)return ya.addRactive(e.root),e.handleChange()}this.root.viewmodel.set(e.keypath,void 0)}}function zn(){var t,e,n=this,i=n.element,r=n.node,s=n.value,a=i.binding;if(t=i.getAttribute("value"),o(s)){for(e=s.length;e--;)if(t==s[e])return void(a.isChecked=r.checked=!0);a.isChecked=r.checked=!1}else a.isChecked=r.checked=s==t}function Hn(){this.node.className=n(this.value)}function Kn(){var t=this,e=t.node,n=t.value;this.root.nodes[n]=e,e.id=n}function Gn(){var t,e;t=this.node,e=this.value,void 0===e&&(e=""),t.style.setAttribute("cssText",e)}function $n(){var t=this.value;void 0===t&&(t=""),this.locked||(this.node.innerHTML=t)}function Yn(){var t=this,e=t.node,n=t.value;e._ractive.value=n,this.locked||(e.value=void 0==n?"":n)}function Jn(){this.locked||(this.node[this.propertyName]=this.value)}function Zn(){var t=this,e=t.node,n=t.namespace,i=t.name,r=t.value,o=t.fragment;n?e.setAttributeNS(n,i,(o||r).toString()):this.isBoolean?r?e.setAttribute(i,""):e.removeAttribute(i):null==r?e.removeAttribute(i):e.setAttribute(i,(o||r).toString())}function Xn(){var t,e,n=this,i=n.name,r=n.element,o=n.node;"id"===i?e=of:"value"===i?"select"===r.name&&"value"===i?e=r.getAttribute("multiple")?Xl:Zl:"textarea"===r.name?e=uf:null!=r.getAttribute("contenteditable")?e=af:"input"===r.name&&(t=r.getAttribute("type"),e="file"===t?xs:"radio"===t&&r.binding&&"name"===r.binding.name?ef:uf):this.isTwoway&&"name"===i?"radio"===o.type?e=tf:"checkbox"===o.type&&(e=nf):"style"===i&&o.style.setAttribute?e=sf:"class"!==i||o.namespaceURI&&o.namespaceURI!==is.html?this.useProperty&&(e=hf):e=rf,e||(e=cf),this.update=e,this.update()}function ti(t,e){var n=e?"svg":"div";return df.innerHTML="<"+n+" "+t+"></"+n+">",I(df.childNodes[0].attributes)}function ei(t,e){for(var n=t.length;n--;)if(t[n].name===e.name)return!1;return!0}function ni(t){for(;t=t.parent;)if("form"===t.name)return t}function ii(){this._ractive.binding.handleChange()}function ri(){var t;Ef.call(this),t=this._ractive.root.viewmodel.get(this._ractive.binding.keypath),this.value=void 0==t?"":t}function oi(){var t=this._ractive.binding,e=this;t._timeout&&clearTimeout(t._timeout),t._timeout=setTimeout(function(){t.rendered&&Ef.call(e),t._timeout=void 0},t.element.lazy)}function si(t,e,n){var i=t+e+n;return Of[i]||(Of[i]=[])}function ai(t){return t.isChecked}function ui(t){return t.element.getAttribute("value")}function hi(t){var e,n,i,r,o,s=t.attributes;return t.binding&&(t.binding.teardown(),t.binding=null),(t.getAttribute("contenteditable")||s.contenteditable&&ci(s.contenteditable))&&ci(s.value)?n=Af:"input"===t.name?(e=t.getAttribute("type"),"radio"===e||"checkbox"===e?(i=ci(s.name),r=ci(s.checked),i&&r&&m("A radio input can have two-way binding on its name attribute, or its checked attribute - not both",{ractive:t.root}),i?n="radio"===e?jf:Rf:r&&(n="radio"===e?Tf:Lf)):"file"===e&&ci(s.value)?n=Bf:ci(s.value)&&(n="number"===e||"range"===e?qf:xf)):"select"===t.name&&ci(s.value)?n=t.getAttribute("multiple")?Mf:If:"textarea"===t.name&&ci(s.value)&&(n=xf),n&&(o=new n(t))&&o.keypath?o:void 0}function ci(t){return t&&t.isBindable}function li(){var t=this.getAction();t&&!this.hasListener?this.listen():!t&&this.hasListener&&this.unrender()}function fi(t){Qa(this.root,this.getAction(),{event:t})}function di(){return this.action.toString().trim()}function pi(t,e,n){var i,r,o,s=this;this.element=t,this.root=t.root,this.parentFragment=t.parentFragment,this.name=e,-1!==e.indexOf("*")&&(l('Only component proxy-events may contain "*" wildcards, <%s on-%s="..."/> is not valid',t.name,e),this.invalid=!0),n.m?(r=n.a.r,this.method=n.m,this.keypaths=[],this.fn=Pc(n.a.s,r.length),this.parentFragment=t.parentFragment,o=this.root,this.refResolvers=[],r.forEach(function(t,e){var n=void 0;(n=Gf.exec(t))?s.keypaths[e]={eventObject:!0,refinements:n[1]?n[1].split("."):[]}:s.refResolvers.push(jc(s,t,function(t){return s.resolve(e,t)}))}),this.fire=mi):(i=n.n||n,"string"!=typeof i&&(i=new rv({template:i,root:this.root,owner:this})),this.action=i,n.d?(this.dynamicParams=new rv({template:n.d,root:this.root,owner:this.element}),this.fire=gi):n.a&&(this.params=n.a,this.fire=vi))}function mi(t){var e,n,i;if(e=this.root,"function"!=typeof e[this.method])throw new Error('Attempted to call a non-existent method ("'+this.method+'")');n=this.keypaths.map(function(n){var i,r,o;if(void 0===n)return void 0;if(n.eventObject){if(i=t,r=n.refinements.length)for(o=0;r>o;o+=1)i=i[n.refinements[o]]}else i=e.viewmodel.get(n);return i}),Wa.enqueue(e,t),i=this.fn.apply(null,n),e[this.method].apply(e,i),Wa.dequeue(e)}function vi(t){Qa(this.root,this.getAction(),{event:t,args:this.params})}function gi(t){var e=this.dynamicParams.getArgsList();"string"==typeof e&&(e=e.substr(1,e.length-2)),Qa(this.root,this.getAction(),{event:t,args:e})}function yi(t){var e,n,i,r={};e=this._ractive,n=e.events[t.type],(i=Tc(n.element.parentFragment))&&(r=Tc.resolve(i)),n.fire({node:this,original:t,index:r,keypath:e.keypath.str,context:e.root.viewmodel.get(e.keypath)})}function bi(){var t,e=this.name;if(!this.invalid){if(t=g("events",this.root,e))this.custom=t(this.node,wi(e));else{if(!("on"+e in this.node||window&&"on"+e in window||ts))return void(Zf[e]||v(Ds(e,"event"),{node:this.node}));this.node.addEventListener(e,$f,!1)}this.hasListener=!0}}function wi(t){return Jf[t]||(Jf[t]=function(e){var n=e.node._ractive;e.index=n.index,e.keypath=n.keypath.str,e.context=n.root.viewmodel.get(n.keypath),n.events[t].fire(e)}),Jf[t]}function ki(t,e){function n(n){n&&n.rebind(t,e)}var i;return this.method?(i=this.element.parentFragment,void this.refResolvers.forEach(n)):("string"!=typeof this.action&&n(this.action),void(this.dynamicParams&&n(this.dynamicParams)))}function Ei(){this.node=this.element.node,this.node._ractive.events[this.name]=this,(this.method||this.getAction())&&this.listen()}function xi(t,e){this.keypaths[t]=e}function _i(){return this.method?void this.refResolvers.forEach(K):("string"!=typeof this.action&&this.action.unbind(),void(this.dynamicParams&&this.dynamicParams.unbind()))}function Ai(){this.custom?this.custom.teardown():this.node.removeEventListener(this.name,$f,!1),this.hasListener=!1}function Ci(){var t=this;this.dirty||(this.dirty=!0,ya.scheduleTask(function(){Oi(t),t.dirty=!1})),this.parentFragment.bubble()}function Oi(t){var e,n,i,r,o;e=t.node,e&&(r=I(e.options),n=t.getAttribute("value"),i=t.getAttribute("multiple"),void 0!==n?(r.forEach(function(t){var e,r;e=t._ractive?t._ractive.value:t.value,r=i?Si(n,e):n==e,r&&(o=!0),t.selected=r}),o||(r[0]&&(r[0].selected=!0),t.binding&&t.binding.forceUpdate())):t.binding&&t.binding.forceUpdate())}function Si(t,e){for(var n=t.length;n--;)if(t[n]==e)return!0}function Ti(t,e){t.select=ji(t.parent),t.select&&(t.select.options.push(t),e.a||(e.a={}),void 0!==e.a.value||e.a.hasOwnProperty("disabled")||(e.a.value=e.f),"selected"in e.a&&void 0!==t.select.getAttribute("value")&&delete e.a.selected)}function Fi(t){t.select&&V(t.select.options,t)}function ji(t){if(t)do if("select"===t.name)return t;while(t=t.parent)}function Pi(t){var e,n,i,r,o,s,a;this.type=Oh,e=this.parentFragment=t.parentFragment,n=this.template=t.template,this.parent=t.pElement||e.pElement,this.root=i=e.root,this.index=t.index,this.key=t.key,this.name=Wl(n.e),"option"===this.name&&Ti(this,n),"select"===this.name&&(this.options=[],this.bubble=Ci),"form"===this.name&&(this.formBindings=[]),a=Bl(this,n),this.attributes=mf(this,n.a),this.conditionalAttributes=yf(this,n.m),n.f&&(this.fragment=new rv({template:n.f,root:i,owner:this,pElement:this,cssIds:null})),s=i.twoway,a.twoway===!1?s=!1:a.twoway===!0&&(s=!0),this.twoway=s,this.lazy=a.lazy,s&&(r=Wf(this,n.a))&&(this.binding=r,o=this.root._twowayBindings[r.keypath.str]||(this.root._twowayBindings[r.keypath.str]=[]),o.push(r)),n.v&&(this.eventHandlers=sd(this,n.v)),n.o&&(this.decorator=new ld(this,n.o)),this.intro=n.t0||n.t1,this.outro=n.t0||n.t2}function Ri(t,e){function n(n){n.rebind(t,e)}var i,r,o,s;if(this.attributes&&this.attributes.forEach(n),this.conditionalAttributes&&this.conditionalAttributes.forEach(n),this.eventHandlers&&this.eventHandlers.forEach(n),this.decorator&&n(this.decorator),this.fragment&&n(this.fragment),o=this.liveQueries)for(s=this.root,i=o.length;i--;)o[i]._makeDirty();this.node&&(r=this.node._ractive)&&E(r,"keypath",t,e)}function Ni(t){var e;(t.attributes.width||t.attributes.height)&&t.node.addEventListener("load",e=function(){var n=t.getAttribute("width"),i=t.getAttribute("height");void 0!==n&&t.node.setAttribute("width",n),void 0!==i&&t.node.setAttribute("height",i),t.node.removeEventListener("load",e,!1)},!1)}function Li(t){t.node.addEventListener("reset",Ii,!1)}function Vi(t){t.node.removeEventListener("reset",Ii,!1)}function Ii(){var t=this._ractive.proxy;ya.start(),t.formBindings.forEach(Di),ya.end()}function Di(t){t.root.viewmodel.set(t.keypath,t.resetValue)}function Mi(t,e,n){var i,r,o;this.element=t,this.root=i=t.root,this.isIntro=n,r=e.n||e,("string"==typeof r||(o=new rv({template:r,root:i,owner:t}),r=o.toString(),o.unbind(),""!==r))&&(this.name=r,e.a?this.params=e.a:e.d&&(o=new rv({template:e.d,root:i,owner:t}),this.params=o.getArgsList(),o.unbind()),this._fn=g("transitions",i,r),this._fn||v(Ds(r,"transition"),{ractive:this.root}))}function Ui(t){return t}function Bi(){Bd.hidden=document[Id]}function qi(){Bd.hidden=!0}function Wi(){Bd.hidden=!1}function Qi(){var t,e,n,i=this;return t=this.node=this.element.node,e=t.getAttribute("style"),this.complete=function(r){n||(!r&&i.isIntro&&zi(t,e),t._ractive.transition=null,i._manager.remove(i),n=!0)},this._fn?void this._fn.apply(this.root,[this].concat(this.params)):void this.complete()}function zi(t,e){e?t.setAttribute("style",e):(t.getAttribute("style"),t.removeAttribute("style"))}function Hi(){var t,e,n,i=this,r=this.root;return t=Ki(this),e=this.node=ls(this.name,t),this.parentFragment.cssIds&&this.node.setAttribute("data-ractive-css",this.parentFragment.cssIds.map(function(t){return"{"+t+"}"}).join(" ")),As(this.node,"_ractive",{value:{proxy:this,keypath:ca(this.parentFragment),events:_s(null),root:r}}),this.attributes.forEach(function(t){return t.render(e)}),this.conditionalAttributes.forEach(function(t){return t.render(e)}),this.fragment&&("script"===this.name?(this.bubble=Zd,this.node.text=this.fragment.toString(!1),this.fragment.unrender=xs):"style"===this.name?(this.bubble=Jd,this.bubble(),this.fragment.unrender=xs):this.binding&&this.getAttribute("contenteditable")?this.fragment.unrender=xs:this.node.appendChild(this.fragment.render())),this.binding&&(this.binding.render(),this.node._ractive.binding=this.binding),this.eventHandlers&&this.eventHandlers.forEach(function(t){return t.render()}),"option"===this.name&&Gi(this),"img"===this.name?Ni(this):"form"===this.name?Li(this):"input"===this.name||"textarea"===this.name?this.node.defaultValue=this.node.value:"option"===this.name&&(this.node.defaultSelected=this.node.selected),this.decorator&&this.decorator.fn&&ya.scheduleTask(function(){i.decorator.torndown||i.decorator.init()},!0),r.transitionsEnabled&&this.intro&&(n=new Xd(this,this.intro,!0),ya.registerTransition(n),ya.scheduleTask(function(){return n.start()},!0),this.transition=n),this.node.autofocus&&ya.scheduleTask(function(){return i.node.focus()},!0),$i(this),this.node}function Ki(t){var e,n,i;return e=(n=t.getAttribute("xmlns"))?n:"svg"===t.name?is.svg:(i=t.parent)?"foreignObject"===i.name?is.html:i.node.namespaceURI:t.root.el.namespaceURI}function Gi(t){var e,n,i;if(t.select&&(n=t.select.getAttribute("value"),void 0!==n))if(e=t.getAttribute("value"),t.select.node.multiple&&o(n)){for(i=n.length;i--;)if(e==n[i]){t.node.selected=!0;break}}else t.node.selected=e==n}function $i(t){var e,n,i,r,o;e=t.root;do for(n=e._liveQueries,i=n.length;i--;)r=n[i],o=n["_"+r],o._test(t)&&(t.liveQueries||(t.liveQueries=[])).push(o);while(e=e.parent)}function Yi(t){var e,n,i;if(e=t.getAttribute("value"),void 0===e||!t.select)return!1;if(n=t.select.getAttribute("value"),n==e)return!0;if(t.select.getAttribute("multiple")&&o(n))for(i=n.length;i--;)if(n[i]==e)return!0}function Ji(t){var e,n,i,r;return e=t.attributes,n=e.type,i=e.value,r=e.name,n&&"radio"===n.value&&i&&r.interpolator&&i.value===r.interpolator.value?!0:void 0}function Zi(t){var e=t.toString();return e?" "+e:""}function Xi(){this.fragment&&this.fragment.unbind(),this.binding&&this.binding.unbind(),this.eventHandlers&&this.eventHandlers.forEach(K),"option"===this.name&&Fi(this),this.attributes.forEach(K),this.conditionalAttributes.forEach(K)}function tr(t){var e,n,i;(i=this.transition)&&i.complete(),"option"===this.name?this.detach():t&&ya.detachWhenReady(this),this.fragment&&this.fragment.unrender(!1),(e=this.binding)&&(this.binding.unrender(),this.node._ractive.binding=null,n=this.root._twowayBindings[e.keypath.str],n.splice(n.indexOf(e),1)),this.eventHandlers&&this.eventHandlers.forEach(G),this.decorator&&ya.registerDecorator(this.decorator),this.root.transitionsEnabled&&this.outro&&(i=new Xd(this,this.outro,!1),ya.registerTransition(i),ya.scheduleTask(function(){return i.start()})),this.liveQueries&&er(this),"form"===this.name&&Vi(this)}function er(t){var e,n,i;for(i=t.liveQueries.length;i--;)e=t.liveQueries[i],n=e.selector,e._remove(t.node)}function nr(t,e){var n=ap.exec(e)[0];return null===t||n.length<t.length?n:t}function ir(t,e,n){var i;if(i=rr(t,e,n||{}))return i;if(i=$u.fromId(e,{noThrow:!0})){i=up(i);var r=$u.parse(i,$u.getParseOptions(t));return t.partials[e]=r.t}}function rr(t,e,n){var i=void 0,r=ar(e,n.owner);if(r)return r;var o=y("partials",t,e);if(o){if(r=o.partials[e],"function"==typeof r&&(i=r.bind(o),i.isOwner=o.partials.hasOwnProperty(e),r=i.call(t,$u)),!r&&""!==r)return void m(Is,e,"partial","partial",{ractive:t});if(!$u.isParsed(r)){var s=$u.parse(r,$u.getParseOptions(o));s.p&&m("Partials ({{>%s}}) cannot contain nested inline partials",e,{ractive:t});var a=i?o:or(o,e);a.partials[e]=r=s.t}return i&&(r._fn=i),r.v?r.t:r}}function or(t,e){return t.partials.hasOwnProperty(e)?t:sr(t.constructor,e)}function sr(t,e){return t?t.partials.hasOwnProperty(e)?t:sr(t._Parent,e):void 0}function ar(t,e){if(e){if(e.template&&e.template.p&&e.template.p[t])return e.template.p[t];if(e.parentFragment&&e.parentFragment.owner)return ar(t,e.parentFragment.owner)}}function ur(t,e){var n,i=y("components",t,e);if(i&&(n=i.components[e],!n._Parent)){var r=n.bind(i);if(r.isOwner=i.components.hasOwnProperty(e),n=r(),!n)return void m(Is,e,"component","component",{ractive:t});"string"==typeof n&&(n=ur(t,n)),n._fn=r,i.components[e]=n}return n}function hr(){var t=this.instance.fragment.detach();return bp.fire(this.instance),t}function cr(t){return this.instance.fragment.find(t)}function lr(t,e){return this.instance.fragment.findAll(t,e)}function fr(t,e){e._test(this,!0),this.instance.fragment&&this.instance.fragment.findAllComponents(t,e)}function dr(t){return t&&t!==this.name?this.instance.fragment?this.instance.fragment.findComponent(t):null:this.instance}function pr(){return this.parentFragment.findNextNode(this)}function mr(){return this.rendered?this.instance.fragment.firstNode():null}function vr(t,e,n){function i(t){var n,i;t.value=e,t.updating||(i=t.ractive,n=t.keypath,t.updating=!0,ya.start(i),i.viewmodel.mark(n),ya.end(),t.updating=!1)}var r,o,s,a,u,h;if(r=t.obj,o=t.prop,n&&!n.configurable){if("length"===o)return;throw new Error('Cannot use magic mode with property "'+o+'" - object is not configurable')}n&&(s=n.get,a=n.set),u=s||function(){return e},h=function(t){a&&a(t),e=s?s():t,h._ractiveWrappers.forEach(i)},h._ractiveWrappers=[t],Object.defineProperty(r,o,{get:u,set:h,enumerable:!0,configurable:!0})}function gr(t,e){var n,i,r,o;if(this.adaptors)for(n=this.adaptors.length,i=0;n>i;i+=1)if(r=this.adaptors[i],r.filter(e,t,this.ractive))return o=this.wrapped[t]=r.wrap(this.ractive,e,t,br(t)),void(o.value=e)}function yr(t,e){var n,i={};if(!e)return t;e+=".";for(n in t)t.hasOwnProperty(n)&&(i[e+n]=t[n]);return i}function br(t){var e;return Wp[t]||(e=t?t+".":"",Wp[t]=function(n,i){var r;return"string"==typeof n?(r={},r[e+n]=i,r):"object"==typeof n?e?yr(n,t):n:void 0}),Wp[t]}function wr(t){var e,n,i=[Ys];for(e=t.length;e--;)for(n=t[e].parent;n&&!n.isRoot;)-1===t.indexOf(n)&&j(i,n),n=n.parent;return i}function kr(t,e,n){var i;xr(t,e),n||(i=e.wildcardMatches(),i.forEach(function(n){Er(t,n,e)}))}function Er(t,e,n){var i,r,o;e=e.str||e,i=t.depsMap.patternObservers,r=i&&i[e],r&&r.forEach(function(e){o=n.join(e.lastKey),xr(t,o),Er(t,e,o)})}function xr(t,e){t.patternObservers.forEach(function(t){t.regex.test(e.str)&&t.update(e)})}function _r(){function t(t){var i=t.key;t.viewmodel===s?(s.clearCache(i.str),t.invalidate(),n.push(i),e(i)):t.viewmodel.mark(i)}function e(n){var i,r;s.noCascade.hasOwnProperty(n.str)||((r=s.deps.computed[n.str])&&r.forEach(t),(i=s.depsMap.computed[n.str])&&i.forEach(e))}var n,i,r,o=this,s=this,a={};return n=this.changes,n.length?(n.slice().forEach(e),i=Qp(n),i.forEach(function(e){var i;-1===n.indexOf(e)&&(i=s.deps.computed[e.str])&&i.forEach(t)}),this.changes=[],this.patternObservers.length&&(i.forEach(function(t){return zp(o,t,!0)}),n.forEach(function(t){return zp(o,t)})),this.deps.observers&&(i.forEach(function(t){return Ar(o,null,t,"observers")}),Or(this,n,"observers")),this.deps["default"]&&(r=[],i.forEach(function(t){return Ar(o,r,t,"default")}),r.length&&Cr(this,r,n),Or(this,n,"default")),n.forEach(function(t){a[t.str]=o.get(t)}),this.implicitChanges={},this.noCascade={},a):void 0}function Ar(t,e,n,i){var r,o;(r=Sr(t,n,i))&&(o=t.get(n),r.forEach(function(t){e&&t.refineValue?e.push(t):t.setValue(o)}))}function Cr(t,e,n){e.forEach(function(e){for(var i=!1,r=0,o=n.length,s=[];o>r;){var a=n[r];if(a===e.keypath){i=!0;break}a.slice(0,e.keypath.length)===e.keypath&&s.push(a),r++}i&&e.setValue(t.get(e.keypath)),s.length&&e.refineValue(s)})}function Or(t,e,n){function i(t){t.forEach(r),t.forEach(o)}function r(e){var i=Sr(t,e,n);i&&a.push({keypath:e,deps:i})}function o(e){var r;(r=t.depsMap[n][e.str])&&i(r)}function s(e){var n=t.get(e.keypath);e.deps.forEach(function(t){return t.setValue(n)})}var a=[];i(e),a.forEach(s)}function Sr(t,e,n){var i=t.deps[n];return i?i[e.str]:null}function Tr(){this.captureGroups.push([])}function Fr(t,e){var n,i;if(e||(i=this.wrapped[t])&&i.teardown()!==!1&&(this.wrapped[t]=null),this.cache[t]=void 0,n=this.cacheMap[t])for(;n.length;)this.clearCache(n.pop())}function jr(t,e){var n=e.firstKey;return!(n in t.data||n in t.computations||n in t.mappings)}function Pr(t,e){var n=new Zp(t,e);return this.ready&&n.init(this),this.computations[t.str]=n}function Rr(t,e){var n,i,r,o,s,a=this.cache,u=t.str;if(e=e||nm,e.capture&&(o=L(this.captureGroups))&&(~o.indexOf(t)||o.push(t)),Ps.call(this.mappings,t.firstKey))return this.mappings[t.firstKey].get(t,e);if(t.isSpecial)return t.value;if(void 0===a[u]?((i=this.computations[u])&&!i.bypass?(n=i.get(),this.adapt(u,n)):(r=this.wrapped[u])?n=r.value:t.isRoot?(this.adapt("",this.data),n=this.data):n=Nr(this,t),a[u]=n):n=a[u],!e.noUnwrap&&(r=this.wrapped[u])&&(n=r.get()),t.isRoot&&e.fullRootGet)for(s in this.mappings)n[s]=this.mappings[s].getValue();return n===tm?void 0:n}function Nr(t,e){var n,i,r,o;return n=t.get(e.parent),(o=t.wrapped[e.parent.str])&&(n=o.get()),null!==n&&void 0!==n?((i=t.cacheMap[e.parent.str])?-1===i.indexOf(e.str)&&i.push(e.str):t.cacheMap[e.parent.str]=[e.str],"object"!=typeof n||e.lastKey in n?(r=n[e.lastKey],t.adapt(e.str,r,!1),t.cache[e.str]=r,r):t.cache[e.str]=tm):void 0}function Lr(){var t;for(t in this.computations)this.computations[t].init(this)}function Vr(t,e){var n=this.mappings[t.str]=new om(t,e);return n.in